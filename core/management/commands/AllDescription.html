<!doctype html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ูุณุชูุฏุงุช ุฏุณุชูุฑุงุช ูุฏุฑุช ุงุฑุฒุงุจ ุนููฺฉุฑุฏ โ ฒฐ ูุงู</title>
<style>
  :root {
    --bg: #f7fafc;       /* ุฑูุดู */
    --card: #ffffff;
    --ink: #1f2937;
    --muted: #6b7280;
    --accent: #7c3aed;   /* ุจููุด */
    --accent-soft: #ede9fe;
    --border: #e5e7eb;
  }
  html, body {
    background: var(--bg);
    color: var(--ink);
    font-family: "Vazirmatn", Tahoma, "IRANSans", Arial, sans-serif;
    line-height: 1.85;
    margin: 0;
    padding: 0;
  }
  .wrap {
    max-width: 1100px;
    margin: auto;
    padding: 24px 16px 80px;
  }
  header.hero {
    background: linear-gradient(180deg, var(--accent-soft), transparent);
    border-bottom: 1px solid var(--border);
    padding: 28px 16px;
    border-radius: 0 0 24px 24px;
  }
  header.hero h1 {
    margin: 0 0 8px 0;
    font-size: 28px;
    font-weight: 800;
    color: var(--accent);
  }
  header.hero p {
    margin: 0;
    color: var(--muted);
    font-size: 14px;
  }
  nav.toc {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 16px 20px;
    margin: 20px 0 28px;
    box-shadow: 0 4px 14px rgba(31,41,55,0.05);
  }
  nav.toc h3 {
    margin: 0 0 10px 0;
    font-size: 16px;
    color: var(--ink);
  }
  nav.toc ul {
    margin: 0;
    padding: 0 18px;
    columns: 2;
    column-gap: 32px;
  }
  nav.toc li {
    margin: 6px 0;
    break-inside: avoid;
  }
  nav.toc a {
    color: var(--accent);
    text-decoration: none;
  }
  nav.toc a:hover {
    text-decoration: underline;
  }
  section.card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 18px 20px;
    margin: 18px 0;
    box-shadow: 0 4px 14px rgba(31,41,55,0.05);
  }
  section.card h2 {
    margin: 0 0 8px 0;
    font-size: 18px;
    display: flex;
    align-items: center;
    gap: 10px;
  }
  section.card .num {
    background: var(--accent);
    color: white;
    font-size: 12px;
    padding: 2px 8px;
    border-radius: 999px;
  }
  section.card .content {
    white-space: pre-wrap; /* preserve linebreaks */
    margin-top: 10px;
  }
  section.card .top {
    margin-top: 10px;
    font-size: 12px;
  }
  .footer {
    color: var(--muted);
    font-size: 13px;
    text-align: center;
    margin-top: 36px;
  }
</style>
</head>
<body>
<a id="top"></a>
<div class="wrap">
  <header class="hero">
    <h1>ูุณุชูุฏุงุช ุฏุณุชูุฑุงุช ูุฏุฑุช ุงุฑุฒุงุจ ุนููฺฉุฑุฏ</h1>
    <p>ูุฌููุนู ฒฐ ุฏุณุชูุฑ ูุฏุฑุช (Management Commands) โ ุจุฑูุฒุฑุณุงู: 2025-11-10 12:42</p>
  </header>

  <nav class="toc">
    <h3>ููุฑุณุช</h3>
    <ul>
      <li><a href="#file-1">01. assign_dual_supervisors.py</a></li><li><a href="#file-2">02. assign_supervisors_from_codes.py</a></li><li><a href="#file-3">03. assign_supervisors_from_unit_manager.py</a></li><li><a href="#file-4">04. backfill_reporting_lines.py</a></li><li><a href="#file-5">05. build_evaluation_links.py</a></li><li><a href="#file-6">06. build_links_fallback_minimal.py</a></li><li><a href="#file-7">07. build_links_from_reporting.py</a></li><li><a href="#file-8">08. build_links_org_head_for_managers.py</a></li><li><a href="#file-9">09. import_employees.py</a></li><li><a href="#file-10">10. import_form_templates.py</a></li><li><a href="#file-11">11. import_reporting_lines.py</a></li><li><a href="#file-12">12. link_specific_subordinates.py</a></li><li><a href="#file-13">13. load_jobroles_from_excel.py</a></li><li><a href="#file-14">14. rebuild_hierarchy_from_excel.py</a></li><li><a href="#file-15">15. set_direct_supervisors_from_units.py</a></li><li><a href="#file-16">16. set_unit_managers_from_codes.py</a></li><li><a href="#file-17">17. set_unit_managers_from_roles.py</a></li><li><a href="#file-18">18. sync_jobrole_units_from_excel.py</a></li><li><a href="#file-19">19. sync_primary_supervisor.py</a></li><li><a href="#file-20">20. sync_profiles_jobroles_from_excel.py</a></li>
    </ul>
  </nav>

  
    <section id="file-1" class="card">
      <h2><span class="num">01</span> assign_dual_supervisors.py</h2>
      <div class="content">๐ ูุงู: assign_dual_supervisors.py
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

### ๐ ุชูุถุญ ฺฉุงุฑฺฉุฑุฏ ูุงู
ุงู ูุงู ฺฉ **management command** ุงุณุชุ ุจู ุงู ูุนูุง ฺฉู ููุท ุฒูุงู ุงุฌุฑุง ูโุดูุฏ ฺฉู ุงุฒ ุชุฑููุงู (Command Line) ุขู ุฑุง ุตุฏุง ุจุฒููุฏุ  
ู ุฏุฑ ุงุฌุฑุง ูุนููู ุจุฑูุงูู ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ูุนุงู ููโุดูุฏ.

ูุฏู ุงุตู ุงู ุฏุณุชูุฑุ ุชูุธู ุฎูุฏฺฉุงุฑ ุฏู ุณุทุญ ุงุฒ ุณุฑูพุฑุณุช ุจุฑุง ฺฉุงุฑฺฉูุงู ุงุณุช:  
ฑ. **ูุฏุฑ ูุณุชูู (direct_supervisor)**  
ฒ. **ุฑุฆุณ (section_head)**  

ฺฉุงุฑ ุงู ุฏุณุชูุฑ ุจูโุตูุฑุช ุฎูุงุตู:
- ุจุฑุง ูุฑ ฺฉุงุฑููุฏ (`EmployeeProfile`) ุฏุฑ ุณุงุฒูุงูุ ุจุฑ ุงุณุงุณ ูุงุญุฏ ู ููุดุ ูุฏุฑ ู ุฑุฆุณ ุชุนู ูโุดูุฏ.
- ููุทู ุงูุชุฎุงุจ ุงู ุฏู ุณุทุญ ุงุฒ ุณุฑูพุฑุณุช ุทุจู ููุงุนุฏ ุฒุฑ ุงุณุช:
  - ุงฺฏุฑ ูุงุญุฏ ยซูุฌุณุชฺฉยป ุจุงุดุฏ โ ูุฏุฑ = ูุฏุฑ ฺฉุงุฑุฎุงูู (org head)
  - ุงฺฏุฑ ูุงุญุฏ ุงุฒ ููุน ูุงูุ ุญุฑุงุณุช ุง ุญุณุงุจุฏุงุฑ ุจุงุดุฏ โ ูุฏุฑ ูุฏุงุฑุฏ (ููุฏ ูุฏุฑ ุฎุงู ุงุณุช)ุ ููุท ุฑุฆุณ ุฏุงุฑุฏ.
  - ุฏุฑ ุณุงุฑ ูุงุญุฏูุง โ ูุฏุฑ ููุงู ูุฏุฑ ูุงุญุฏ ุงุณุช ู ุฑุฆุณ ฺฉุณ ุงุณุช ฺฉู ุดุบู ุงู ุดุงูู ูุงฺูโ ยซุฑุฆุณยป ุจุงุดุฏ.

๐ ูุซุงู ุงุฌุฑุง ุฏุณุชูุฑ:
```bash
python manage.py assign_dual_supervisors --org "ูุงู ุณุงุฒูุงู" --org-head 220001
```
ุฏุฑ ุตูุฑุช ุงุณุชูุงุฏู ุงุฒ ฺฏุฒููโ `--dry-run`ุ ููุท ฺฏุฒุงุฑุด ุฏุงุฏู ูโุดูุฏ ู ูฺ ุชุบุฑ ุฏุฑ ุฏุชุงุจุณ ุฐุฎุฑู ููโฺฏุฑุฏุฏ.

---

### โ๏ธ ูุญูู ุนููฺฉุฑุฏ
- ุฏุงุฏูโูุง ูพุฑุณูู ุงุฒ ูุฏู `EmployeeProfile` ุฎูุงูุฏู ูโุดููุฏ.
- ุจุฑุง ูุฑ ฺฉุงุฑููุฏุ ูุงุญุฏ ุณุงุฒูุงู (`unit`) ู ููุด ุดุบู (`job_role`) ุจุฑุฑุณ ูโุดูุฏ.
- ููุงุนุฏ ุฎุงุต ุจุฑุง ูุงุญุฏูุง ูุดุฎุต ูุงููุฏ ูุฌุณุชฺฉุ ูุงู ู ุญุฑุงุณุช ุงุนูุงู ูโุดูุฏ.
- ุฏุฑ ุตูุฑุช ุชุบุฑุ ุงุทูุงุนุงุช ุฏุฑ ุฏุชุงุจุณ ุจูโุฑูุฒุฑุณุงู ูโุดููุฏ.
- ฺฏุฒุงุฑุด ููุง ุดุงูู ุชุนุฏุงุฏ ุฑฺฉูุฑุฏูุง ุงุตูุงุญโุดุฏู ุงุณุช.

---

### ๐งฉ ูฺฺฏโูุง ู ุณุงุฎุชุงุฑ ุฏุงุฎู
- ุงุฒ ุชุฑุงฺฉูุด ุงุชูฺฉ ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุฐุฎุฑูโ ูุงูุต ุฏุงุฏูโูุง ุงุณุชูุงุฏู ูโุดูุฏ.
- ุฏุฑ ูพุงุงู ุงุฌุฑุงุ ฺฏุฒุงุฑุด ฺฉุงูู ุงุฒ ุนููุงุช ฺุงูพ ูโฺฏุฑุฏุฏ.
- ุจุง ุณุงุฎุชุงุฑ `--dry-run` ุงูฺฉุงู ุจุฑุฑุณ ูุชุงุฌ ุจุฏูู ุชุบุฑ ุฏุงุฏูโูุง ูุฑุงูู ุงุณุช.

---

### ๐ ุขุง ูุงุฒู ุงุณุช ูฺฏูโุฏุงุฑ ุดูุฏุ
โ ุจููุ ูฺฏูโุฏุงุฑ ุขู ุชูุตู ูโุดูุฏ.  
ุงู ูุงู ฺฉ ุงุฒ ุงุจุฒุงุฑูุง ุงุตู ุจุฑุง ููฺฏุงูโุณุงุฒ ุงูููโ ุฏุงุฏูโูุง ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุงุณุช.  
ุฏุฑ ููฺฏุงู ุงุฌุงุฏ ุฏุชุงุจุณ ุฌุฏุฏ ุง ููฺฏุงู ูุฑูุฏ ุฏุงุฏูโูุง ูพุฑุณูู ุงุฒ ุณุณุชูโูุง HR ุฏฺฏุฑ (ูุซูุงู ุงุฒ ุงฺฉุณู)ุ  
ุงู ุฏุณุชูุฑ ุชุถูู ูโฺฉูุฏ ุฑูุงุจุท ูุฏุฑโุฑุฆุณ ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ู ุฏูู ุชูุธู ุดููุฏ.

๐ก ุฏุฑ ฺู ุดุฑุงุท ูโุชูุงู ุขู ุฑุง ุญุฐู ฺฉุฑุฏุ
ููุท ุฏุฑ ุตูุฑุช ฺฉู:
- ูพุฑูฺู ุฏุฑ ูุฑุญููโ ูพุงุฏุงุฑ ููุง ูุฑุงุฑ ุฏุงุดุชู ุจุงุดุฏุ  
- ู ุฏฺฏุฑ ูฺ ุฏุงุฏูโุง ุงุฒ ููุงุจุน ุฎุงุฑุฌ (ูุซู ุงฺฉุณู) ูุงุฑุฏ ูุดูุฏุ  
- ู ุฑูุงุจุท ูุฏุฑ ู ุฑุฆุณ ููุดู ุจูโุตูุฑุช ุฏุณุช ุฏุฑ ูพูู ุงุฏูู ุชุนู ฺฏุฑุฏูุฏ.  

ุงูุง ุชุง ุฒูุงู ฺฉู ุฏุงุฏูโูุง ุงุฒ HR ุง ูุงูโูุง ุงฺฉุณู ูุงุฑุฏ ูโุดููุฏุ ุญุฐู ุงู ูุงู ุชูุตู ููโุดูุฏ.
</div>
      <div class="top"><a href="#top">โ ุจุงุฒฺฏุดุช ุจู ููุฑุณุช</a></div>
    </section>
    
    <section id="file-2" class="card">
      <h2><span class="num">02</span> assign_supervisors_from_codes.py</h2>
      <div class="content">๐ ูุงู: assign_supervisors_from_codes.py
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

### ๐ ุชูุถุญ ฺฉุงุฑฺฉุฑุฏ ูุงู
ุงู ูุงู ฺฉ **management command** ุงุณุช ู ููุท ุงุฒ ุทุฑู ุฎุท ูุฑูุงู (Command Line) ุงุฌุฑุง ูโุดูุฏ.  
ฺฉุงุฑ ุงุตู ุขู ุชูุธู ููุฏ **ูุฏุฑ ูุณุชูู (direct_supervisor)** ุจุฑุง ฺฉุงุฑฺฉูุงู ุจุฑ ุงุณุงุณ ุงุทูุงุนุงุช HR ููุฌูุฏ ุฏุฑ ูุงู Excel ุงุณุช.

ูุธูู ูุงู:
- ูุงู ุงฺฉุณู ุฑุง ูโุฎูุงูุฏ ู ุณุชููโูุง `role_level` ู `unit_code` ุฑุง ุชุญูู ูโฺฉูุฏ.
- ุจุฑ ุงุณุงุณ ุณุทุญ ููุดุ ุฑูุงุจุท ูุฏุฑุช ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุณุงุฎุชู ูโุดูุฏ.
- ููุทู ุฒูุฌุฑู ุจู ุดฺฉู ุฒุฑ ุงุณุช:
  ```
  904 โ 903 โ 902 โ 901 โ 900
  ```
  ุนู ฺฉุงุฑููุฏุงู ุณุทุญ ูพุงูโุชุฑ ุจู ููุฑุงุช ุจุงูุงุชุฑ ูุชุตู ูโุดููุฏ.
- ูุฏุฑุงู ูุงุญุฏ (`901`) ูุณุชููุงู ุฒุฑ ูุฏุฑ ฺฉุงุฑุฎุงูู (`900`) ูุฑุงุฑ ูโฺฏุฑูุฏ.

๐ ููููู ุงุฌุฑุง ุฏุณุชูุฑ:
```bash
python manage.py assign_supervisors_from_codes employees.xlsx --org "ูุงู ุณุงุฒูุงู" --org-head 220001
```
ุฏุฑ ุญุงูุช ุชุณุช ุง ฺฏุฒุงุฑุด ุจุฏูู ุชุบุฑ:
```bash
python manage.py assign_supervisors_from_codes employees.xlsx --dry-run
```
ฺฏุฒูู `--dry-run` ุจุงุนุซ ูโุดูุฏ ููุท ฺฏุฒุงุฑุด ฺุงูพ ุดูุฏ ุจุฏูู ุชุบุฑ ูุงูุน ุฏุฑ ุฏุชุงุจุณ.

---

### โ๏ธ ูุญูู ุนููฺฉุฑุฏ
- ุฏุงุฏูโูุง ุงุฒ ูุงู ุงฺฉุณู ุจุง ฺฉุชุงุจุฎุงููโ `pandas` ุฎูุงูุฏู ูโุดููุฏ.
- ุณุชููโูุง ููุฑุฏ ูุงุฒ (role_level ู unit_code) ุงุนุชุจุงุฑุณูุฌ ูโุดููุฏ.
- ุจุง ููุงุณูโ role_level ู ููุฏูุง ูุฑุชุจุทุ ุจุฑุง ูุฑ ฺฉุงุฑููุฏ ูุฏุฑ ูุณุชูู ุงูุชุฎุงุจ ูโุดูุฏ.
- ุฑฺฉูุฑุฏูุง ฺฉู ุฏุงุฏูโ ฺฉุงู ูุฏุงุฑูุฏุ ุฏุฑ ฺฏุฒุงุฑุด ููุง ุจูโุนููุงู skipped ฺุงูพ ูโุดููุฏ.

---

### ๐ง ุณุงุฎุชุงุฑ ู ููุทู ุฏุงุฎู
- ุงุฒ ูฺฏุงุดุช ุณุทุญ ููุดโูุง (Role Level Mapping) ุจุฑุง ุญูุธ ุฏูุช ุฑูุงุจุท ุงุณุชูุงุฏู ูโุดูุฏ.
- ุจุฑุง ุณุฑุนุช ู ฺฉุงุฑุงุ ุนููุงุช ุจูโุตูุฑุช bulk update ุงูุฌุงู ูโุดูุฏ.
- ูพุดุชุจุงู ฺฉุงูู ุงุฒ ูพุงุฑุงูุชุฑูุง `--org` ู `--dry-run` ุฏุงุฑุฏ.

---

### ๐ ุขุง ูุงุฒู ุงุณุช ูฺฏูโุฏุงุฑ ุดูุฏุ
โ ุจููุ ูฺฏูโุฏุงุฑ ุขู ุถุฑูุฑ ุงุณุช.  
ุงู ุฏุณุชูุฑ ฺฉ ุงุฒ ุงุจุฒุงุฑูุง ููู ุจุฑุง ููุงููฺฏ ุงุทูุงุนุงุช HR ุจู ุงฺฉุณู ู ุณุณุชู ุงุฑุฒุงุจ ุนููฺฉุฑุฏ ุงุณุช.  
ุจุง ุขู ูโุชูุงู ุฑูุงุจุท ูุฏุฑ ูุณุชูู ุฑุง ุฏุฑ ูุฑ ุฒูุงู ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุจุงุฒุณุงุฒ ฺฉุฑุฏ.

๐ก ุฏุฑ ฺู ุดุฑุงุท ูโุชูุงู ุญุฐู ฺฉุฑุฏุ  
ุงฺฏุฑ ุณุงุฎุชุงุฑ ุณุงุฒูุงู ุชููุง ุงุฒ ุทุฑู ุณุณุชู HR ุงุตู (ูุซู Odoo ุง APIูุง ุฏุงุฎู) ุณุงุฎุชู ุดูุฏ ู ูฺ ูุงู ุงฺฉุณู ุจุฑุง ุฏุงุฏูโูุง HR ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏุ  
ุฏุฑ ุขู ุตูุฑุช ุญุฐู ุขู ุจูุงูุงูุน ุงุณุช.  
ุงูุง ุจุฑุง ูุญุท ูุนู ู ูุฑุขูุฏูุง HR ูุนูุ ูุฌูุฏ ุงู ูุงู ุถุฑูุฑ ู ุญุงุช ุงุณุช.
</div>
      <div class="top"><a href="#top">โ ุจุงุฒฺฏุดุช ุจู ููุฑุณุช</a></div>
    </section>
    
    <section id="file-3" class="card">
      <h2><span class="num">03</span> assign_supervisors_from_unit_manager.py</h2>
      <div class="content">๐ ูุงู: assign_supervisors_from_unit_manager.py
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

### ๐ ุชูุถุญ ฺฉุงุฑฺฉุฑุฏ ูุงู
ุงู ูุงู ฺฉ **management command** ุงุณุช ฺฉู ููุท ุงุฒ ุทุฑู ุฎุท ูุฑูุงู ุงุฌุฑุง ูโุดูุฏ.  
ูุฏู ุขู ุชูุธู ุฎูุฏฺฉุงุฑ ููุฏ **direct_supervisor** ุจุฑุง ุชูุงู ฺฉุงุฑฺฉูุงู ุงุณุช ุชุง ูุฏุฑ ูุณุชูู ูุฑ ฺฉุงุฑููุฏ ุงุฒ ูุฏุฑ ูุงุญุฏ ููุงู ุจุฎุด ฺฏุฑูุชู ุดูุฏ.

ูุธูู ุงุตู ุงู ุฏุณุชูุฑ:
- ุจุฑุฑุณ ุชูุงู `EmployeeProfile`โูุง ู ุงูุชู ูุงุญุฏ (`unit`) ูุฑุชุจุท ุจุง ูุฑ ฺฉุงุฑููุฏ.  
- ุฏุฑ ุตูุฑุช ูุฌูุฏ ูุฏุฑ ุฏุฑ ุขู ูุงุญุฏ (`Unit.manager`)ุ ููุฏ `direct_supervisor` ุจู ููุงู ูุฏุฑ ููุฏุงุฑุฏู ูโุดูุฏ.
- ุฏุฑ ุตูุฑุช ฺฉู ฺฏุฒูู `--only-null` ูุนุงู ุจุงุดุฏุ ููุท ุฑฺฉูุฑุฏูุง ฺฉู ูุฏุฑ ูุณุชูู ูุฏุงุฑูุฏ ุชุบุฑ ูโฺฉููุฏ.  
- ุงฺฏุฑ ฺฉุงุฑููุฏ ุฎูุฏุด ูุฏุฑ ููุงู ูุงุญุฏ ุจุงุดุฏุ ุงุฒ ุชูุธู ูุฌุฏุฏ ุตุฑูโูุธุฑ ูโุดูุฏ.

๐ ูุญูู ุงุฌุฑุง:
```bash
python manage.py assign_supervisors_from_unit_manager --org "ููุช ุงููุงุณ" --only-null
```
ฺฏุฒููโ `--dry-run` ุจุฑุง ุงุฌุฑุง ุขุฒูุงุด ุจุฏูู ุชุบุฑ ุฏุฑ ุฏุชุงุจุณ ูุฒ ูพุดุชุจุงู ูโุดูุฏ.

---

### โ๏ธ ูุญูู ุนููฺฉุฑุฏ
- ูุงุญุฏูุง ุงุฒ ูุฏู `Unit` ุฎูุงูุฏู ูโุดููุฏ ู ูุฏุฑุงู ูุฑุชุจุท ุจุง ูุฑ ูุงุญุฏ ุจุงุฑฺฏุฐุงุฑ ูโุดููุฏ.
- ุจุฑุง ูุฑ ูุงุญุฏุ ุงุนุถุง ุฒุฑูุฌููุนู ุจุง ููุชุฑ `EmployeeProfile.unit` ฺฏุฑูุชู ูโุดููุฏ.
- ุงุนุถุง ุบุฑูุฏุฑ ุฏุฑ ฺฉ `bulk update` ุจูโุตูุฑุช ฺฏุฑูู ุจูโุฑูุฒุฑุณุงู ูโุดููุฏ.
- ูุชุงุฌ ููุง ุจูโุตูุฑุช ฺฏุฒุงุฑุด ุฏุฑ ุฎุฑูุฌ ููุงุด ุฏุงุฏู ูโุดูุฏ.

---

### ๐ง ุณุงุฎุชุงุฑ ู ููุทู ุฏุงุฎู
- ุงุฒ ุชุฑุงฺฉูุด ุงูู (atomic) ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุฐุฎุฑูโ ูุงูุต ุงุณุชูุงุฏู ุดุฏู ุงุณุช.  
- ุงูฺฉุงู ููุชุฑ ฺฉุฑุฏู ุจุฑ ุงุณุงุณ ุณุงุฒูุงู (`--org`) ู ุญุฐู ุจุฑุฎ ูุงุญุฏูุง (`--exclude-units`) ูุฌูุฏ ุฏุงุฑุฏ.  
- ูุฑุขูุฏ ุจููู ู ุณุฑุน ุงุณุช ู ุจุฏูู ูุงุฒ ุจู ุชฺฉุฑุงุฑ ฺฉูุฆุฑ ุจุฑุง ูุฑ ฺฉุงุฑููุฏ ุงุฌุฑุง ูโุดูุฏ.

---

### ๐ ุขุง ูุงุฒู ุงุณุช ูฺฏูโุฏุงุฑ ุดูุฏุ
โ ุจููุ ูฺฏูโุฏุงุฑ ุงู ูุงู ุถุฑูุฑ ุงุณุช.  
ุฒุฑุง ุงู ุงุจุฒุงุฑ ุฏุฑ ููุงููฺฏโุณุงุฒ ุณุฑุน ุฑูุงุจุท ุจู ฺฉุงุฑฺฉูุงู ู ูุฏุฑุงู ููุด ุญุงุช ุฏุงุฑุฏ.  
ุฏุฑ ุฒูุงูโูุง ฺฉู ุฏุงุฏูโูุง ุงุฒ HR ุงููพูุฑุช ุดุฏู ูู ุฑูุงุจุท ูุณุชูู ูููุฒ ุชูุธู ูุดุฏูโุงูุฏุ ุงู ูุงู ฺฉุงุฑ ุฑุง ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุงูุฌุงู ูโุฏูุฏ.

๐ก ุฏุฑ ฺู ุดุฑุงุท ูโุชูุงู ุญุฐู ฺฉุฑุฏุ  
ููุท ุฏุฑ ุตูุฑุช ฺฉู ุฑูุงุจุท ุณุฑูพุฑุณุช ุจูโุตูุฑุช ฺฉุงูู ู ูพุงุฏุงุฑ ุงุฒ ุทุฑู ุงุจุฒุงุฑูุง ุฎูุฏฺฉุงุฑ (ูุงููุฏ `rebuild_hierarchy_from_excel.py`) ุจุงุฒุณุงุฒ ุดูุฏ.
</div>
      <div class="top"><a href="#top">โ ุจุงุฒฺฏุดุช ุจู ููุฑุณุช</a></div>
    </section>
    
    <section id="file-4" class="card">
      <h2><span class="num">04</span> backfill_reporting_lines.py</h2>
      <div class="content">๐ ูุงู: backfill_reporting_lines.py
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

### ๐ ุชูุถุญ ฺฉุงุฑฺฉุฑุฏ ูุงู
ุงู ูุงู ฺฉ **management command** ุงุณุช ู ุจุฑุง ุจุงุฒุณุงุฒ ุง ุชฺฉูู ุฌุฏูู ุฑูุงุจุท ฺฏุฒุงุฑุดโุฏู (`ReportingLine`) ุทุฑุงุญ ุดุฏู ุงุณุช.  
ูุฏู ุขู ููฺฏุงูโุณุงุฒ ุงุทูุงุนุงุช ุจู ูุฏูโูุง `EmployeeProfile` ู `ReportingLine` ุงุณุช.

ุนููฺฉุฑุฏ ฺฉู:
- ุจุฑุง ูุฑ `EmployeeProfile` ฺฉู ูุฏุฑ ูุณุชูู ุฏุงุฑุฏุ ฺฉ ุฑฺฉูุฑุฏ ูุชูุงุธุฑ ุฏุฑ `ReportingLine` ุงุฌุงุฏ ุง ุจูโุฑูุฒุฑุณุงู ูโฺฉูุฏ.
- ุงฺฏุฑ ฺฉุงุฑููุฏ ูุฏุฑ ูุณุชูู ูุฏุงุฑุฏุ ุงุฒ ุงุฌุงุฏ ุฑุงุจุทู ุตุฑูโูุธุฑ ูโุดูุฏ.
- ุฏุฑ ุญุงูุช `--dry-run` ููุท ูพุดโููุงุด ุชุบุฑุงุช ุงุฑุงุฆู ูโุดูุฏ ู ุฏุชุงุจุณ ุชุบุฑ ููโฺฉูุฏ.

๐ ูุญูู ุงุฌุฑุง:
```bash
python manage.py backfill_reporting_lines
```
ุงู ุฏุณุชูุฑ ุจุฏูู ูุงุฒ ุจู ูพุงุฑุงูุชุฑ ุงุถุงู ุงุฌุฑุง ูโุดูุฏ ู ุฏุฑ ุตูุฑุช ูุฌูุฏ ุชุบุฑุงุชุ ุขูโูุง ุฑุง ุฏุฑ ุฏุชุงุจุณ ุฐุฎุฑู ูโฺฉูุฏ.

---

### โ๏ธ ูุญูู ุนููฺฉุฑุฏ
1. ุชูุงู ฺฉุงุฑฺฉูุงู (`EmployeeProfile`) ุฎูุงูุฏู ูโุดููุฏ.
2. ุฏุฑ ุตูุฑุช ฺฉู ููุฏ `direct_supervisor` ููุฏุงุฑ ุฏุงุดุชู ุจุงุดุฏุ ุฑฺฉูุฑุฏ `ReportingLine` ูุฑุจูุท ุจู ุขู ุจูโุฑูุฒุฑุณุงู ูโุดูุฏ.
3. ุงฺฏุฑ ุฑฺฉูุฑุฏ ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏุ ุงุฌุงุฏ ูโุดูุฏ.
4. ุชูุงู ูุฑุขูุฏ ุฏุฑ ูุงูุจ ฺฉ ุชุฑุงฺฉูุด ุงุชูฺฉ ุงูุฌุงู ูโุดูุฏ ุชุง ุฏุฑ ุตูุฑุช ุฎุทุงุ ุชุบุฑุงุช ุจุฑฺฏุฑุฏูุฏ.

---

### ๐ง ุณุงุฎุชุงุฑ ู ููุทู ุฏุงุฎู
- ุงู ูุงู ุชุถูู ูโฺฉูุฏ ฺฉู ุณุงุฎุชุงุฑ ุณุงุฒูุงู ุฏุฑ ุฌุฏูู `ReportingLine` ููุดู ุจูโุฑูุฒ ุจุงุดุฏ.  
- ุฏุงุฏูโูุง ุงุฒ ูุฏู ูพุฑุณูู ฺฏุฑูุชู ูโุดููุฏ ู ุฏุฑ ุตูุฑุช ูุงุฒ ุงุตูุงุญ ูโฺฏุฑุฏูุฏ.  
- ุฏุฑ ุงูุชูุง ุงุฌุฑุงุ ฺฏุฒุงุฑุด ุงุฒ ุชุนุฏุงุฏ ุฑูุงุจุท ุงุฌุงุฏ ุง ุจูโุฑูุฒุฑุณุงูโุดุฏู ููุงุด ุฏุงุฏู ูโุดูุฏ.

---

### ๐ ุขุง ูุงุฒู ุงุณุช ูฺฏูโุฏุงุฑ ุดูุฏุ
โ ุจููุ ุงู ูุงู ุจุฎุด ููู ุงุฒ ุณุณุชู ุงุฑุฒุงุจ ุนููฺฉุฑุฏ ุงุณุช.  
ฺุฑุง ฺฉู ุจุณุงุฑ ุงุฒ ฺฏุฒุงุฑุดโูุง ู ูุฑุขูุฏูุง ุงุฑุฒุงุจ ุงุฒ ุฏุงุฏูโูุง `ReportingLine` ุงุณุชูุงุฏู ูโฺฉููุฏ.  
ุจุฏูู ุงู ูุงูุ ูุงุฒู ุฎูุงูุฏ ุจูุฏ ฺฉู ุฑูุงุจุท ฺฏุฒุงุฑุดโุฏู ุจูโุตูุฑุช ุฏุณุช ุชุนุฑู ุดููุฏ ฺฉู ุจุงุนุซ ุฎุทุง ู ุงุชูุงู ุฒูุงู ูโุดูุฏ.

๐ก ุฏุฑ ฺู ุดุฑุงุท ูโุชูุงู ุญุฐู ฺฉุฑุฏุ  
ููุท ุงฺฏุฑ ุณุณุชู ุงุฑุฒุงุจ ุชุตูู ุจฺฏุฑุฏ ฺฉุงููุงู ุจุฏูู ูุฏู `ReportingLine` ฺฉุงุฑ ฺฉูุฏ ู ุชูุงู ุฑูุงุจุท ุฏุฑ `EmployeeProfile` ุฐุฎุฑู ุดููุฏ.
</div>
      <div class="top"><a href="#top">โ ุจุงุฒฺฏุดุช ุจู ููุฑุณุช</a></div>
    </section>
    
    <section id="file-5" class="card">
      <h2><span class="num">05</span> build_evaluation_links.py</h2>
      <div class="content">๐ ูุงู: build_evaluation_links.py
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

### ๐ ุชูุถุญ ฺฉุงุฑฺฉุฑุฏ ูุงู
ุงู ูุงู ฺฉ **management command** ูพุดุฑูุชู ุงุณุช ฺฉู ุจุฑุง ุณุงุฎุช ู ุจูโุฑูุฒุฑุณุงู ุฑูุงุจุท ุงุฑุฒุงุจ ุนููฺฉุฑุฏ (`EvaluationLink`) ุทุฑุงุญ ุดุฏู ุงุณุช.  
ูุฏู ุขู ุชุนู ุงู ุงุณุช ฺฉู ฺู ฺฉุณ ฺู ฺฉุณ ุฑุง ุงุฑุฒุงุจ ูโฺฉูุฏ ุจุฑ ุงุณุงุณ ุณุงุฎุชุงุฑ ูุงูุน ุณุงุฒูุงู.

ูุธูู ฺฉู:
- ุงุฌุงุฏ ุง ุงุตูุงุญ ุฑฺฉูุฑุฏูุง `EvaluationLink` ุจุฑุง ููู ฺฉุงุฑฺฉูุงู.
- ูพุดุชุจุงู ุงุฒ ฺูุฏ ููุน ููฺฉ ูุฎุชูู ุจู ุงุฑุฒุงุจ ู ุงุฑุฒุงุจโุดููุฏู:
  - **DIRECT_SUPERVISOR** โ ูุฏุฑ ูุณุชูู
  - **SECTION_HEAD** โ ุฑุฆุณ ูุงุญุฏ
  - **SUPERVISOR** โ ุณุฑูพุฑุณุช
  - **UNIT_MANAGER** โ ูุฏุฑ ูุงุญุฏ
  - **ORG_HEAD** โ ูุฏุฑ ฺฉุงุฑุฎุงูู (ุฏุฑ ุฑุฃุณ ุณุงุฎุชุงุฑ)

๐ ูุญูู ุงุฌุฑุง:
```bash
python manage.py build_evaluation_links --org "ููุช ุงููุงุณ" --head-pcode 220001 --types DIRECT,UNIT_MANAGER,ORG_HEAD
```
ุฏุฑ ุญุงูุช ฺฏุฒุงุฑุด ุจุฏูู ุชุบุฑ:
```bash
python manage.py build_evaluation_links --org "ููุช ุงููุงุณ" --dry-run
```
ฺฏุฒููโ `--types` ุชุนู ูโฺฉูุฏ ฺู ููุน ููฺฉโูุง ุณุงุฎุชู ุดููุฏุ ู `--dry-run` ููุท ฺฏุฒุงุฑุด ุชููุฏ ูโฺฉูุฏ.

---

### โ๏ธ ูุญูู ุนููฺฉุฑุฏ
1. ุฏุงุฏูโูุง ุงุฒ ูุฏูโูุง `EmployeeProfile` ู `ReportingLine` ุฎูุงูุฏู ูโุดููุฏ.  
2. ุจุฑ ุงุณุงุณ ููุด ู ุฌุงฺฏุงู ุงูุฑุงุฏ ุฏุฑ ุณุงุฒูุงูุ ุฑูุงุจุท ุงุฑุฒุงุจ ุงุฌุงุฏ ูโุดูุฏ.  
3. ุฏุฑ ุตูุฑุช ฺฉู ููฺฉ ุงุฒ ูุจู ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏุ ุจูโุฑูุฒุฑุณุงู ูโฺฏุฑุฏุฏ.  
4. ุงฺฏุฑ ุงุฑุฒุงุจโุดููุฏู ูุงูุฏ ูุฏุฑ ูุณุชูู ุจุงุดุฏุ ููฺฉ ORG_HEAD ุจุฑุง ุงู ุณุงุฎุชู ูโุดูุฏ.

---

### ๐ง ุณุงุฎุชุงุฑ ู ููุทู ุฏุงุฎู
- ุงุฒ ูฺฏุงุดุช ููุน ููฺฉ ุจุฑุง ุชุดุฎุต ุฏูู ุงุฑุฒุงุจโูุง ุงุณุชูุงุฏู ูโุดูุฏ.  
- ุจูููโุณุงุฒ ุดุฏู ุจุฑุง ุนููฺฉุฑุฏ ุณุฑุน ุฏุฑ ุณุงุฒูุงูโูุง ุจุฒุฑฺฏ.  
- ุชุฑุงฺฉูุด ุงุชูฺฉ ุงุฒ ุจุฑูุฒ ูุงุณุงุฒฺฏุงุฑ ุฏุงุฏูโูุง ุฌููฺฏุฑ ูโฺฉูุฏ.  
- ูพุงุฑุงูุชุฑูุง `--dry-run` ู `--types` ุงูุนุทุงู ุจุงูุง ุฏุฑ ุงุฌุฑุง ุงุฌุงุฏ ูโฺฉููุฏ.

---

### ๐ ุฌุงฺฏุงู ุฏุฑ ุณุณุชู ุงุฑุฒุงุจ
ุงู ูุงู ูุณุชู ุงุตู ูุฑุขูุฏ ุงุฑุฒุงุจ ุนููฺฉุฑุฏ ุงุณุช ู ุณุงุฑ ูุงูโูุง ูุงููุฏ `backfill_reporting_lines.py`ุ  
`build_links_fallback_minimal.py` ู `sync_primary_supervisor.py` ุจุฑ ูพุงู ุฏุงุฏูโูุง ุชููุฏุดุฏู ุชูุณุท ุขู ฺฉุงุฑ ูโฺฉููุฏ.

---

### ๐ ุขุง ูุงุฒู ุงุณุช ูฺฏูโุฏุงุฑ ุดูุฏุ
โ ุจููุ ูฺฏูโุฏุงุฑ ุขู ุถุฑูุฑ ุงุณุช.  
ุงู ูุงู ุณุชูู ููุฑุงุช ุณุณุชู ุงุฑุฒุงุจ ุนููฺฉุฑุฏ ุงุณุช ู ุชูุงู ฺฏุฒุงุฑุดโูุง ู ูุฑุงูุฏูุง HR ุจู ุฏุงุฏูโูุง ุขู ูุชฺฉ ูุณุชูุฏ.

๐ก ุฏุฑ ฺู ุดุฑุงุท ูโุชูุงู ุญุฐู ฺฉุฑุฏุ  
ุฏุฑ ูฺ ุญุงูุช ุนูู ุชูุตู ุจู ุญุฐู ุงู ูุงู ููโุดูุฏ ูฺฏุฑ ุฒูุงู ฺฉู ฺฉู ุณุณุชู ุงุฑุฒุงุจ ุนููฺฉุฑุฏ ุจูโุตูุฑุช ุฎุงุฑุฌ (ูุซูุงู ุฏุฑ ERP) ูพุงุฏูโุณุงุฒ ุดุฏู ุจุงุดุฏ.
</div>
      <div class="top"><a href="#top">โ ุจุงุฒฺฏุดุช ุจู ููุฑุณุช</a></div>
    </section>
    
    <section id="file-6" class="card">
      <h2><span class="num">06</span> build_links_fallback_minimal.py</h2>
      <div class="content">๐ ูุงู: build_links_fallback_minimal.py
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

### ๐ ุชูุถุญ ฺฉุงุฑฺฉุฑุฏ ูุงู
ุงู ุฏุณุชูุฑ ฺฉ ูุณุฎู ุณุงุฏูโุชุฑ ุงุฒ `build_evaluation_links.py` ุงุณุช ู ูุฏู ุขู ูพุฑ ฺฉุฑุฏู ุฑูุงุจุท ุฌุงุงูุชุงุฏู ุฏุฑ ุฌุฏูู `EvaluationLink` ุงุณุช.  
ุนููฺฉุฑุฏ ุขู ุจุฑ ุฑู ุงูุฑุงุฏ ูุชูุฑฺฉุฒ ุงุณุช ฺฉู ูฺ ููฺฉ ุงุฑุฒุงุจ ูุฏุงุฑูุฏ.

ูุธูู ฺฉู:
- ุฌุณุชุฌู ฺฉุงุฑฺฉูุงู ฺฉู ุฏุฑ ุฌุฏูู `EvaluationLink` ูุงูุฏ ุงุฑุฒุงุจ ูุณุชูุฏ.  
- ุงุฌุงุฏ ููฺฉ ุงุฒ ููุน **ORG_HEAD** ุจุฑุง ุขูโูุง (ุนู ูุณุชููุงู ุฒุฑ ูุฏุฑ ฺฉุงุฑุฎุงูู).

๐ ูุญูู ุงุฌุฑุง:
```bash
python manage.py build_links_fallback_minimal --org "ููุช ุงููุงุณ" --head-pcode 220001
```
ุฏุฑ ุญุงูุช ุขุฒูุงุด ุจุฏูู ุชุบุฑ:
```bash
python manage.py build_links_fallback_minimal --dry-run
```
ุฏุฑ ุญุงูุช dry-run ููุท ฺฏุฒุงุฑุด ุฏุงุฏู ูโุดูุฏ ู ูฺ ุชุบุฑ ูุงูุน ุงูุฌุงู ููโฺฏุฑุฏ.

---

### โ๏ธ ูุญูู ุนููฺฉุฑุฏ
1. ุชูุงู ูพุฑููุงูโูุง ฺฉุงุฑฺฉูุงู (`EmployeeProfile`) ุฎูุงูุฏู ูโุดููุฏ.  
2. ุจุฑุฑุณ ูโุดูุฏ ฺฉู ุขุง ุจุฑุง ูุฑ ฺฉุงุฑููุฏ ููฺฉ ุฏุฑ `EvaluationLink` ูุฌูุฏ ุฏุงุฑุฏ ุง ุฎุฑ.  
3. ุฏุฑ ุตูุฑุช ูุจูุฏ ููฺฉุ ฺฉ ุฑฺฉูุฑุฏ ุฌุฏุฏ ุงุฒ ููุน ORG_HEAD ุงุฌุงุฏ ูโุดูุฏ.  
4. ููู ุนููุงุช ุฏุฑ ฺฉ ุชุฑุงฺฉูุด ุงุชูฺฉ ุงูุฌุงู ูโุดูุฏ ุชุง ุงุฒ ูุงููุงููฺฏ ุฏุงุฏู ุฌููฺฏุฑ ุดูุฏ.

---

### ๐ง ุณุงุฎุชุงุฑ ู ููุทู ุฏุงุฎู
- ุณุงุฎุชุงุฑ ุณุงุฏู ู ุงูู ุจุง ุชูุฑฺฉุฒ ุจุฑ ููฺฉโูุง ุงุฒ ุฏุณุชโุฑูุชู.  
- ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุฎุทุง ุงูุณุงู ุฏุฑ ูุฑูุฏ ุฏุณุช ุฏุงุฏูโูุง ุงุณุชูุงุฏู ูโุดูุฏ.  
- ููุท ุจุง ุฏุงุฏูโูุง ูุงูุน `EmployeeProfile` ฺฉุงุฑ ูโฺฉูุฏ ู ูุงุฒ ุจู ูุฏูโูุง ุฏฺฏุฑ ูุฏุงุฑุฏ.

---

### ๐ ุฌุงฺฏุงู ุฏุฑ ุณุณุชู ุงุฑุฒุงุจ
ุงู ูุงู ูฺฉูู ูุงู ุงุตู `build_evaluation_links.py` ุงุณุช.  
ุฏุฑ ุณูุงุฑููุง ฺฉู ุฏุงุฏูโูุง ูุงูุต ุจุงุดูุฏ ุง ุจุฑุฎ ฺฉุงุฑฺฉูุงู ุจุฏูู ุงุฑุฒุงุจ ุจุงู ุจูุงููุฏุ  
ุงู ุฏุณุชูุฑ ุขูโูุง ุฑุง ูุณุชููุงู ุจู ูุฏุฑ ฺฉุงุฑุฎุงูู ูุชุตู ูโฺฉูุฏ ุชุง ุณุงุฎุชุงุฑ ุงุฑุฒุงุจ ฺฉุงูู ุดูุฏ.

---

### ๐ ุขุง ูุงุฒู ุงุณุช ูฺฏูโุฏุงุฑ ุดูุฏุ
โ ุจููุ ุจูุชุฑ ุงุณุช ูฺฏูโุฏุงุฑ ุดูุฏ.  
ุฒุฑุง ุงู ูุงู ููุด ุงุจุฒุงุฑ ุงุตูุงุญ ุงุถุทุฑุงุฑ ุฑุง ุฏุงุฑุฏ ู ุฏุฑ ุณูุงุฑููุง ูุงูุต ุง ูพุณ ุงุฒ ุงููพูุฑุช ุฏุงุฏูโูุง ุงุฒ HR ุจุณุงุฑ ููุฏ ุงุณุช.

๐ก ุฏุฑ ฺู ุดุฑุงุท ูโุชูุงู ุญุฐู ฺฉุฑุฏุ  
ุงฺฏุฑ ุงุทููุงู ฺฉุงูู ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ ฺฉู ูููโ ฺฉุงุฑฺฉูุงู ุงุฒ ุทุฑู ูุงูโูุง ุงุตู (`build_evaluation_links.py`) ููฺฉโูุง ุงุฑุฒุงุจ ุฏุงุฑูุฏุ  
ุฏุฑ ุขู ุตูุฑุช ุญุฐู ุขู ุจโุถุฑุฑ ุงุณุช.
</div>
      <div class="top"><a href="#top">โ ุจุงุฒฺฏุดุช ุจู ููุฑุณุช</a></div>
    </section>
    
    <section id="file-7" class="card">
      <h2><span class="num">07</span> build_links_from_reporting.py</h2>
      <div class="content">๐ ูุงู: build_links_from_reporting.py
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

### ๐ ุชูุถุญ ฺฉุงุฑฺฉุฑุฏ ูุงู
ุงู ูุงู ฺฉ **management command** ุงุณุช ฺฉู ุจุฑุง ุณุงุฎุช ุง ุจูโุฑูุฒุฑุณุงู ุฑูุงุจุท ุงุฑุฒุงุจ (`EvaluationLink`) ุงุฒ ุฑู ุฌุฏูู ฺฏุฒุงุฑุดโุฏู (`ReportingLine`) ุทุฑุงุญ ุดุฏู ุงุณุช.  
ูุฏู ุขู ุงุฌุงุฏ ููฺฉโูุง ุงุฑุฒุงุจ ุจุฑุง ููุดโูุง ูุงููุฏ ุฑุฆุณ (SECTION_HEAD) ู ุณุฑูพุฑุณุช (SUPERVISOR) ุงุณุช.

ูุธูู ฺฉู:
- ุฎูุงูุฏู ุชูุงู ุฑูุงุจุท ฺฏุฒุงุฑุดโุฏู ุงุฒ ูุฏู `ReportingLine`.
- ุดูุงุณุง ููุน ุฑุงุจุทู ุจุฑ ุงุณุงุณ ุนููุงู ุดุบู ูุฏุฑ (job_role.name).
- ุณุงุฎุช ุง ุจูโุฑูุฒุฑุณุงู ููฺฉโูุง ุงุฑุฒุงุจ ุฏุฑ ุฌุฏูู `EvaluationLink`.

๐ ูุญูู ุงุฌุฑุง:
```bash
python manage.py build_links_from_reporting --org "ููุช ุงููุงุณ"
```
ฺฏุฒููโ `--dry-run` ูุฒ ุจุฑุง ุงุฌุฑุง ุขุฒูุงุด ุฏุฑ ุฏุณุชุฑุณ ุงุณุช.

---

### โ๏ธ ูุญูู ุนููฺฉุฑุฏ
1. ุชูุงู ุฑฺฉูุฑุฏูุง `ReportingLine` ุจุฑุง ุณุงุฒูุงู ูุดุฎุตโุดุฏู ุฎูุงูุฏู ูโุดููุฏ.  
2. ุนููุงู ุดุบู ูุฏุฑ (supervisor) ุจุฑุฑุณ ูโุดูุฏ ุชุง ููุน ุฑุงุจุทู ุชุดุฎุต ุฏุงุฏู ุดูุฏ:
   - ุงฺฏุฑ ุนููุงู ุดุงูู ยซุฑุฆุณยป ุง ยซุฑุณยป ุจุงุดุฏ โ ููฺฉ ุงุฒ ููุน `SECTION_HEAD` ุงุฌุงุฏ ูโุดูุฏ.
   - ุงฺฏุฑ ุนููุงู ุดุงูู ยซุณุฑูพุฑุณุชยป ุจุงุดุฏ โ ููฺฉ ุงุฒ ููุน `SUPERVISOR` ุณุงุฎุชู ูโุดูุฏ.
3. ุงฺฏุฑ ููฺฉ ุงุฒ ูุจู ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏุ ุงุทูุงุนุงุช ุขู ุจูโุฑูุฒุฑุณุงู ูโุดูุฏ.
4. ุงุฌุฑุง ูุงู ุฏุฑ ุญุงูุช `--dry-run` ููุท ฺฏุฒุงุฑุด ุชููุฏ ูโฺฉูุฏ ุจุฏูู ุชุบุฑ ุฏุฑ ุฏุชุงุจุณ.

---

### ๐ง ุณุงุฎุชุงุฑ ู ููุทู ุฏุงุฎู
- ุงุฒ ููุฏูุง `job_role` ุจุฑุง ุชุญูู ููุน ููุด ุงุณุชูุงุฏู ูโฺฉูุฏ.  
- ุงุฒ ุชุฑุงฺฉูุด ุงูู (atomic) ุจุฑุง ุญูุธ ฺฉูพุงุฑฺฺฏ ุฏุงุฏูโูุง ุจูุฑู ูโุจุฑุฏ.  
- ฺฏุฒุงุฑุด ุฎุฑูุฌ ุดุงูู ุชุนุฏุงุฏ ููฺฉโูุง ุฌุฏุฏ ู ุชุนุฏุงุฏ ููฺฉโูุง ุจูโุฑูุฒุฑุณุงูโุดุฏู ุงุณุช.

---

### ๐ ุฌุงฺฏุงู ุฏุฑ ุณุณุชู ุงุฑุฒุงุจ
ุงู ุฏุณุชูุฑ ูพู ุงุฑุชุจุงุท ูุงู ุณุงุฎุชุงุฑ ุณูุณููโูุฑุงุชุจ (`ReportingLine`) ู ุณุณุชู ุงุฑุฒุงุจ ุนููฺฉุฑุฏ (`EvaluationLink`) ุงุณุช.  
ุฏุฑ ูุงูุน ุฏุงุฏูโูุง ฺฏุฒุงุฑุดโุฏู ุฑุง ุจู ุฒุจุงู ุงุฑุฒุงุจ ุชุฑุฌูู ูโฺฉูุฏ.  
ุฏุฑ ฺฉูุงุฑ ูุงูโูุง ูุงููุฏ `build_evaluation_links.py` ู `backfill_reporting_lines.py` ุงุณุชูุงุฏู ูโุดูุฏ.

---

### ๐ ุขุง ูุงุฒู ุงุณุช ูฺฏูโุฏุงุฑ ุดูุฏุ
โ ุจููุ ูฺฏูโุฏุงุฑ ุขู ุถุฑูุฑ ุงุณุช.  
ฺุฑุง ฺฉู ุงู ูุงู ูุธููโ ุงุฌุงุฏ ููฺฉโูุง ุฑุฆุณ ู ุณุฑูพุฑุณุช ุฑุง ุจุฑ ุนูุฏู ุฏุงุฑุฏ.  
ุฏุฑ ูุจูุฏ ุขูุ ุจุฎุด ุงุฒ ุณุงุฎุชุงุฑ ุงุฑุฒุงุจ ูุงูุต ุฎูุงูุฏ ูุงูุฏ.

๐ก ุฏุฑ ฺู ุดุฑุงุท ูโุชูุงู ุญุฐู ฺฉุฑุฏุ  
ุชููุง ุฏุฑ ุตูุฑุช ฺฉู ุณุงุฎุชุงุฑ ฺฏุฒุงุฑุดโุฏู (`ReportingLine`) ุฏฺฏุฑ ุงุณุชูุงุฏู ูุดูุฏ ู ุชูุงู ููฺฉโูุง ุงุฑุฒุงุจ ูุณุชููุงู ุงุฒ ุฑู ูุฏูโูุง ูพุฑุณูู ุณุงุฎุชู ุดููุฏ.
</div>
      <div class="top"><a href="#top">โ ุจุงุฒฺฏุดุช ุจู ููุฑุณุช</a></div>
    </section>
    
    <section id="file-8" class="card">
      <h2><span class="num">08</span> build_links_org_head_for_managers.py</h2>
      <div class="content">๐ ูุงู: build_links_org_head_for_managers.py
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

### ๐ ุชูุถุญ ฺฉุงุฑฺฉุฑุฏ ูุงู
ุงู ูุงู ฺฉ **management command** ุงุณุช ฺฉู ุจุฑุง ุงุฌุงุฏ ููฺฉโูุง ุงุฑุฒุงุจ ุงุฒ ููุน `ORG_HEAD` ูุฎุตูุต ูุฏุฑุงู ุทุฑุงุญ ุดุฏู ุงุณุช.  
ูุฏู ุขู ุงู ุงุณุช ฺฉู ุชูุงู ูุฏุฑุงู ูุงุญุฏูุง ุฒุฑูุฌููุนูโ ูุณุชูู ูุฏุฑ ฺฉุงุฑุฎุงูู ูุฑุงุฑ ุจฺฏุฑูุฏ.

ูุธูู ฺฉู:
- ุดูุงุณุง ุชูุงู ฺฉุงุฑุจุฑุงู ุจุง ููุด ูุฏุฑุช (ูุฏุฑ ูุงุญุฏุ ูุฏุฑ ุจุฎุดุ ู ุบุฑู).  
- ุญุฐู ุฎูุฏ ูุฏุฑ ฺฉุงุฑุฎุงูู ุงุฒ ูุณุช.  
- ุณุงุฎุช ุง ุจูโุฑูุฒุฑุณุงู ููฺฉโูุง `ORG_HEAD` ุจุฑุง ููู ูุฏุฑุงู ุดูุงุณุงโุดุฏู.

๐ ูุญูู ุงุฌุฑุง:
```bash
python manage.py build_links_org_head_for_managers --org "ููุช ุงููุงุณ" --head-pcode 220001
```
ุฏุฑ ุญุงูุช ุขุฒูุงุด:
```bash
python manage.py build_links_org_head_for_managers --dry-run
```

---

### โ๏ธ ูุญูู ุนููฺฉุฑุฏ
1. ุชูุงู ูุฏุฑุงู ูุงุญุฏูุง ุงุฒ ูุฏู `Unit` ู ููุฏ `manager` ุงุณุชุฎุฑุงุฌ ูโุดููุฏ.  
2. ุนูุงููโุจุฑ ุขูุ ูุฑ ูุฑุฏ ฺฉู ุนููุงู ุดุบู ุงู ุดุงูู ูุงฺูโูุง ูุงููุฏ ยซูุฏุฑยปุ `manager` ุง `department` ุจุงุดุฏ ูุฒ ุจูโุนููุงู ูุฏุฑ ุดูุงุณุง ูโุดูุฏ.  
3. ููฺฉโูุง `ORG_HEAD` ุจุฑุง ูุฑ ูุฏุฑ (ุจูโุฌุฒ ูุฏุฑ ฺฉุงุฑุฎุงูู) ุณุงุฎุชู ุง ุงุตูุงุญ ูโุดููุฏ.  
4. ุฏุฑ ุญุงูุช dry-run ููุท ฺฏุฒุงุฑุด ฺุงูพ ูโุดูุฏ.

---

### ๐ง ุณุงุฎุชุงุฑ ู ููุทู ุฏุงุฎู
- ุงุฒ ุงูฺฏู Regex ุจุฑุง ุชุดุฎุต ููุดโูุง ูุฏุฑุช ุงุณุชูุงุฏู ูโุดูุฏ.  
- ุงุฒ ุชุฑุงฺฉูุด ุงุชูฺฉ ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุฎุทุงูุง ููุฒูุงู ุฏุงุฏู ุจูุฑู ูโุจุฑุฏ.  
- ุงูุนุทุงูโูพุฐุฑ ู ูุงุจู ุงุณุชูุงุฏู ุฏุฑ ุณุงุฒูุงูโูุง ฺูุฏุณุทุญ ุงุณุช.

---

### ๐ ุฌุงฺฏุงู ุฏุฑ ุณุณุชู ุงุฑุฒุงุจ
ุงู ูุงู ููุด ูฺฉูู ุฏุฑ ุณุงุฎุช ุณุงุฎุชุงุฑ ููุง ุงุฑุฒุงุจ ุฏุงุฑุฏ.  
ุจุนุฏ ุงุฒ ุขูฺฉู ููฺฉโูุง ุณุฑูพุฑุณุช ู ุฑุฆุณ ุณุงุฎุชู ุดุฏูุฏุ ุงู ุฏุณุชูุฑ ุงุฑุชุจุงุท ูุฏุฑุงู ูุงุญุฏ ุฑุง ุจุง ูุฏุฑ ฺฉุงุฑุฎุงูู ุจุฑูุฑุงุฑ ูโฺฉูุฏ ุชุง ูุฑู ุงุฑุฒุงุจ ฺฉุงูู ุดูุฏ.

---

### ๐ ุขุง ูุงุฒู ุงุณุช ูฺฏูโุฏุงุฑ ุดูุฏุ
โ ุจููุ ุงู ูุงู ุจุงุฏ ูฺฏูโุฏุงุฑ ุดูุฏ.  
ุฒุฑุง ุจุฑุง ุชูุธู ุณุฑุน ุฑูุงุจุท ุจู ูุฏุฑุงู ู ูุฏุฑ ฺฉุงุฑุฎุงูู ฺฉุงุฑุจุฑุฏ ุฏุงุฑุฏ ู ุฏุฑ ูุฑุขูุฏูุง ุงุตูุงุญ ุณุงุฎุชุงุฑ ุจุณุงุฑ ูุคุซุฑ ุงุณุช.

๐ก ุฏุฑ ฺู ุดุฑุงุท ูโุชูุงู ุญุฐู ฺฉุฑุฏุ  
ุงฺฏุฑ ูุงู `build_evaluation_links.py` ุจูโุทูุฑ ฺฉุงูู ุชูุงู ููฺฉโูุง ORG_HEAD ุฑุง ูพูุดุด ุฏูุฏ ู ูุงุฒ ุจู ุงุฌุฑุง ุฌุฏุงฺฏุงูู ูุจุงุดุฏุ ูโุชูุงู ุญุฐู ุขู ุฑุง ุฏุฑ ูุธุฑ ฺฏุฑูุช.
</div>
      <div class="top"><a href="#top">โ ุจุงุฒฺฏุดุช ุจู ููุฑุณุช</a></div>
    </section>
    
    <section id="file-9" class="card">
      <h2><span class="num">09</span> import_employees.py</h2>
      <div class="content">๐ ูุงู: import_employees.py
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

### ๐ ุชูุถุญ ฺฉุงุฑฺฉุฑุฏ ูุงู
ุงู ูุงู ฺฉ **management command** ุจุฑุง ุงููพูุฑุช ุฎูุฏฺฉุงุฑ ุงุทูุงุนุงุช ฺฉุงุฑฺฉูุงู ุงุฒ ูุงู Excel ุงุณุช.  
ูุฏู ุขู ุณุงุฎุช ุง ุจูโุฑูุฒุฑุณุงู ฺฉุงุฑุจุฑุงู (`User`) ู ูพุฑููุงูโูุง ูพุฑุณูู (`EmployeeProfile`) ุฏุฑ ุณุณุชู ุงุณุช.

ูุธูู ฺฉู:
- ุฎูุงูุฏู ุงุทูุงุนุงุช ูพุฑุณูู ุงุฒ ุงฺฉุณู (ุณุชููโูุง ูุงููุฏ ฺฉุฏ ูพุฑุณููุ ูุงูุ ุณุงุฒูุงูุ ูุงุญุฏุ ุดุบู).  
- ุณุงุฎุช ฺฉุงุฑุจุฑุงู ุฌุฏุฏ ุฏุฑ ุตูุฑุช ูุจูุฏู ุฑฺฉูุฑุฏ ุฏุฑ ุฏุชุงุจุณ.  
- ุงุฌุงุฏ ุง ุจูโุฑูุฒุฑุณุงู ูพุฑููุงู ูพุฑุณูู ูุฑุชุจุท ุจุง ูุฑ ฺฉุงุฑุจุฑ.  
- ุฏุฑ ุตูุฑุช ูุงุฒุ ุงุฌุงุฏ ุฎูุฏฺฉุงุฑ ุณุงุฒูุงูโูุงุ ูุงุญุฏูุง ุง ููุดโูุง ุดุบู.

๐ ูุญูู ุงุฌุฑุง:
```bash
python manage.py import_employees employees.xlsx --autocreate-units --autocreate-roles --create-orgs
```
ฺฏุฒููโูุง:
- `--autocreate-units` : ุงฺฏุฑ ูุงุญุฏ ุฏุฑ ูุงู ูุฌูุฏ ูุฏุงุดุชุ ุฎูุฏฺฉุงุฑ ุณุงุฎุชู ูโุดูุฏ.  
- `--autocreate-roles` : ุฏุฑ ุตูุฑุช ูุจูุฏ ููุด ุดุบูุ ุขู ุฑุง ุงุฌุงุฏ ูโฺฉูุฏ.  
- `--dry-run` : ุงุฌุฑุง ุขุฒูุงุด ุจุฏูู ุงุนูุงู ุชุบุฑ.

---

### โ๏ธ ูุญูู ุนููฺฉุฑุฏ
1. ูุงู ุงฺฉุณู ุฎูุงูุฏู ูโุดูุฏ ู ุณุชููโูุง ุงุตู ุดูุงุณุง ูโฺฏุฑุฏูุฏ.  
2. ุจุฑุง ูุฑ ุฑุฏู:
   - ุงฺฏุฑ ฺฉุงุฑุจุฑ ุจุง ฺฉุฏ ูพุฑุณูู ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏ โ ุณุงุฎุชู ูโุดูุฏ.
   - ุงฺฏุฑ ฺฉุงุฑุจุฑ ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ โ ุงุทูุงุนุงุชุด ุจูโุฑูุฒุฑุณุงู ูโุดูุฏ.
   - ูพุฑููุงู ูพุฑุณูู (`EmployeeProfile`) ูุฒ ุงุฌุงุฏ ุง ุงุตูุงุญ ูโฺฏุฑุฏุฏ.
3. ุฏุฑ ุตูุฑุช ูุฌูุฏ ุณุชูู `direct_supervisor_personnel_code`ุ ุงุฑุชุจุงุท ุณุฑูพุฑุณุช ุชูุธู ูโุดูุฏ.
4. ุฏุฑ ูพุงุงู ฺฏุฒุงุฑุด ุงุฒ ุฑฺฉูุฑุฏูุง ุณุงุฎุชูโุดุฏู ู ุฎุทุงูุง ููุงุด ุฏุงุฏู ูโุดูุฏ.

---

### ๐ง ุณุงุฎุชุงุฑ ู ููุทู ุฏุงุฎู
- ุงุฒ ฺฉุชุงุจุฎุงููโ `pandas` ุจุฑุง ุฎูุงูุฏู ุฏุงุฏูโูุง ุงุณุชูุงุฏู ุดุฏู ุงุณุช.  
- ุงุฒ ุณุณุชู ุชุฑุงฺฉูุด ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุฏุงุฏูโูุง ูุงูุต ุงุณุชูุงุฏู ููโฺฉูุฏ ุงูุง ูุฑ ุฑฺฉูุฑุฏ ุจูโุตูุฑุช ูุฌุฒุง ุฐุฎุฑู ูโุดูุฏ.  
- ุฏุฑ ุจุฑุงุจุฑ ุฏุงุฏูโูุง ุชฺฉุฑุงุฑ ููุงูู ุงุณุช (get_or_create).

---

### ๐ ุฌุงฺฏุงู ุฏุฑ ุณุณุชู ุงุฑุฒุงุจ
ุงู ูุงู ููุทูโ ุดุฑูุน ุชูุงู ูุฑุขูุฏูุง HR ู ุงุฑุฒุงุจ ุนููฺฉุฑุฏ ุงุณุช.  
ุณุงุฑ ุฏุณุชูุฑุงุช ูุงููุฏ `assign_supervisors_from_codes.py`ุ `set_unit_managers_from_codes.py` ู `build_evaluation_links.py` ุจุฑ ุฏุงุฏูโูุง ุงููพูุฑุชโุดุฏู ุชูุณุท ุงู ูุงู ุชฺฉู ุฏุงุฑูุฏ.

---

### ๐ ุขุง ูุงุฒู ุงุณุช ูฺฏูโุฏุงุฑ ุดูุฏุ
โ ุจููุ ฺฉุงููุงู ุถุฑูุฑ ุงุณุช.  
ุฒุฑุง ุงู ูุงู ูพุงูโ ุฏุงุฏูโูุง ุณุงุฒูุงู ุฑุง ุชุดฺฉู ูโุฏูุฏ ู ุจุฏูู ุขู ูฺ ูุฑุขูุฏ ุงุฑุฒุงุจ ูุงุจู ุงูุฌุงู ูุณุช.

๐ก ุฏุฑ ฺู ุดุฑุงุท ูโุชูุงู ุญุฐู ฺฉุฑุฏุ  
ุฏุฑ ุตูุฑุช ฺฉู ูุงุฑุฏ ฺฉุฑุฏู ุฏุงุฏูโูุง ุงุฒ ุทุฑู API ุฎุงุฑุฌ ุงูุฌุงู ุดูุฏ ู ุฏฺฏุฑ ูุงุฒ ุจู ูุงู Excel ูุจุงุดุฏ.
</div>
      <div class="top"><a href="#top">โ ุจุงุฒฺฏุดุช ุจู ููุฑุณุช</a></div>
    </section>
    
    <section id="file-10" class="card">
      <h2><span class="num">10</span> import_form_templates.py</h2>
      <div class="content">๐ ูุงู: import_form_templates.py
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

### ๐ ุชูุถุญ ฺฉุงุฑฺฉุฑุฏ ูุงู
ุงู ูุงู ฺฉ **management command** ุจุฑุง ุงููพูุฑุช ุฎูุฏฺฉุงุฑ ูุฑูโูุง ุงุฑุฒุงุจ ุงุฒ ูุงูโูุง Excel ุงุณุช.  
ูุฏู ุขู ุงุฌุงุฏ ุง ุจูโุฑูุฒุฑุณุงู ูุงูุจโูุง ูุฑู ุงุฑุฒุงุจ (`FormTemplate`) ู ูุนุงุฑูุง ูุฑุชุจุท ุจุง ุขูโูุง ุงุณุช.

ูุธูู ฺฉู:
- ุฎูุงูุฏู ุงุทูุงุนุงุช ูุฑูโูุง ุงุฒ ูุงูโูุง Excel ุฏุฑ ูพูุดูโ ูุดุฎุตโุดุฏู.  
- ุณุงุฎุช ุฑฺฉูุฑุฏูุง `FormTemplate`, `FormCriterion` ู `FormOption`.  
- ูพุดุชุจุงู ุงุฒ ฺูุฏ ุดุช ุจุฑุง ุชุนุฑู ูุฑู ู ุณูุงูุงุช.

๐ ูุญูู ุงุฌุฑุง:
```bash
python manage.py import_form_templates --dir "forms/"
```
ุง ุจุฑุง ูุงูโูุง ุฎุงุต:
```bash
python manage.py import_form_templates --files HR-F-80.xlsx HR-F-81.xlsx
```
ุฏุฑ ุญุงูุช dry-run:
```bash
python manage.py import_form_templates --dry-run
```

---

### โ๏ธ ูุญูู ุนููฺฉุฑุฏ
1. ูุงู ุง ูพูุดูโ ุฏุงุฏูโุดุฏู ุจุฑุฑุณ ูโุดูุฏ.  
2. ุงุฒ ูุฑ ูุงู ุฏู ุดุช ุฎูุงูุฏู ูโุดูุฏ:
   - ุดุช ุงูู ุดุงูู ูุดุฎุตุงุช ูุฑู (ฺฉุฏุ ูุงูุ ูุณุฎูุ ูุถุนุช).
   - ุดุช ุฏูู ุดุงูู ุณูุงูุงุช ู ฺฏุฒููโูุง ุงูุชุงุฒุฏู.  
3. ูุฑู ุฏุฑ ุตูุฑุช ฺฉู ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ ู ุฏุฑ ูุถุนุช Draft ุจุงุดุฏุ ุจูโุฑูุฒุฑุณุงู ูโุดูุฏ.  
4. ูุนุงุฑูุง ู ฺฏุฒููโูุง ูุจู ุงุฒ ุงููพูุฑุช ุฌุฏุฏ ุญุฐู ู ุจุงุฒุณุงุฒ ูโุดููุฏ.  
5. ุฏุฑ ุตูุฑุช ุฎุทุงุ ุชุฑุงฺฉูุด ุจุฑูโฺฏุฑุฏุฏ.

---

### ๐ง ุณุงุฎุชุงุฑ ู ููุทู ุฏุงุฎู
- ุงุฒ `openpyxl` ุจุฑุง ุฎูุงูุฏู ูุงูโูุง Excel ุงุณุชูุงุฏู ูโฺฉูุฏ.  
- ุงุฒ ุชุฑุงฺฉูุด ุงุชูฺฉ ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุฏุงุฏูโูุง ูุงูุต ุจูุฑู ูโุจุฑุฏ.  
- ูุนุงุฑูุง ู ฺฏุฒููโูุง ุจูโุตูุฑุช ุชุฑุชุจ ู ุจุง ูุฒู ูุดุฎุต ุฏุฑ ุฏุชุงุจุณ ุฐุฎุฑู ูโุดููุฏ.

---

### ๐ ุฌุงฺฏุงู ุฏุฑ ุณุณุชู ุงุฑุฒุงุจ
ุงู ูุงู ุฏุงุฏูโูุง ูุฑุจูุท ุจู ูุฑูโูุง ุงุฑุฒุงุจ ุนููฺฉุฑุฏ ุฑุง ูุงุฑุฏ ุณุณุชู ูโฺฉูุฏ.  
ุชูุงู ูุฑุขูุฏูุง ุจุนุฏ ูุงููุฏ ุซุจุช ุงุฑุฒุงุจโูุง ู ูุญุงุณุจูโ ุงูุชุงุฒูุง ุจู ุฏุงุฏูโูุง ูุงุฑุฏุดุฏู ุงุฒ ุงู ูุงู ูุชฺฉ ูุณุชูุฏ.

---

### ๐ ุขุง ูุงุฒู ุงุณุช ูฺฏูโุฏุงุฑ ุดูุฏุ
โ ุจููุ ูฺฏูโุฏุงุฑ ุขู ุถุฑูุฑ ุงุณุช.  
ุฒุฑุง ุจุฑุง ูุฑ ูุณุฎูโ ุฌุฏุฏ ูุฑู ุงุฑุฒุงุจ ุง ุงูุฒูุฏู ูุฑูโูุง ุฌุฏุฏ ุงุฒ HR ููุฑุฏ ูุงุฒ ุงุณุช.

๐ก ุฏุฑ ฺู ุดุฑุงุท ูโุชูุงู ุญุฐู ฺฉุฑุฏุ  
ุงฺฏุฑ ุณุงุฎุช ุง ุจูโุฑูุฒุฑุณุงู ูุฑูโูุง ููุท ุงุฒ ุทุฑู ูพูู ุงุฏูู ุงูุฌุงู ุดูุฏ ู ุฏฺฏุฑ ูุงุฒ ุจู ุงููพูุฑุช ุงุฒ ูุงูโูุง ุงฺฉุณู ูุจุงุดุฏ.
</div>
      <div class="top"><a href="#top">โ ุจุงุฒฺฏุดุช ุจู ููุฑุณุช</a></div>
    </section>
    
    <section id="file-11" class="card">
      <h2><span class="num">11</span> import_reporting_lines.py</h2>
      <div class="content">๐ ูุงู: import_reporting_lines.py
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

### ๐ ุชูุถุญ ฺฉุงุฑฺฉุฑุฏ ูุงู
ุงู ูุงู ฺฉ **management command** ุงุณุช ฺฉู ุจุฑุง ุงููพูุฑุช ูุณุชูู ุฑูุงุจุท ฺฏุฒุงุฑุดโุฏู (`ReportingLine`) ุงุฒ ูุงู Excel ุทุฑุงุญ ุดุฏู ุงุณุช.  
ูุฏู ุขู ุณุงุฎุช ุง ุจูโุฑูุฒุฑุณุงู ุฑูุงุจุท ุจู ฺฉุงุฑฺฉูุงู (ุฒุฑุฏุณุช ู ุณุฑูพุฑุณุช) ุฏุฑ ุณุณุชู ุงุฑุฒุงุจ ุนููฺฉุฑุฏ ุงุณุช.

ูุธูู ฺฉู:
- ุฎูุงูุฏู ุฏุงุฏูโูุง ุฑูุงุจุท ุณุฑูพุฑุณุช ุงุฒ ุงฺฉุณู.  
- ุงุฌุงุฏ ุง ุจูโุฑูุฒุฑุณุงู ุฑฺฉูุฑุฏูุง ุฌุฏูู `ReportingLine`.  
- ููโุฒูุงูโุณุงุฒ ููุฏ `direct_supervisor` ุฏุฑ `EmployeeProfile` ุจุฑุง ุญูุธ ููุงููฺฏ.

๐ ูุญูู ุงุฌุฑุง:
```bash
python manage.py import_reporting_lines reporting_lines.xlsx --org "ููุช ุงููุงุณ"
```
ุฏุฑ ุญุงูุช dry-run:
```bash
python manage.py import_reporting_lines reporting_lines.xlsx --org "ููุช ุงููุงุณ" --dry-run
```

---

### โ๏ธ ูุญูู ุนููฺฉุฑุฏ
1. ูุงู ุงฺฉุณู ุฎูุงูุฏู ูโุดูุฏ ู ุณุชููโูุง ุฒุฑ ุงุณุชุฎุฑุงุฌ ูโุดููุฏ:
   - `subordinate_personnel_code` โ ฺฉุฏ ูพุฑุณูู ุฒุฑุฏุณุช  
   - `supervisor_personnel_code` โ ฺฉุฏ ูพุฑุณูู ุณุฑูพุฑุณุช  
   - (ุงุฎุชุงุฑ) `organization` โ ูุงู ุณุงุฒูุงู  
2. ุจุฑุง ูุฑ ุฑุฏูุ ฺฉุงุฑุจุฑ ุฒุฑุฏุณุช ู ุณุฑูพุฑุณุช ูพุฏุง ูโุดูุฏ.  
3. ุฏุฑ ุตูุฑุช ูุจูุฏ ุฑฺฉูุฑุฏุ ุฑุงุจุทู ุฌุฏุฏ ุณุงุฎุชู ูโุดูุฏ ู ุฏุฑ ุบุฑ ุงู ุตูุฑุช ุจูโุฑูุฒุฑุณุงู ูโฺฏุฑุฏุฏ.  
4. ุฏุฑ ููุงุช ููุฏ `direct_supervisor` ุฏุฑ ูพุฑููุงู ุฒุฑุฏุณุช ุจูโุฑูุฒ ูโุดูุฏ.

---

### ๐ง ุณุงุฎุชุงุฑ ู ููุทู ุฏุงุฎู
- ุงุฒ ุชุฑุงฺฉูุด ุงุชูฺฉ ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุฐุฎุฑูโ ูุงูุต ุฏุงุฏูโูุง ุงุณุชูุงุฏู ูโฺฉูุฏ.  
- ุจูโุตูุฑุช ููุฒูุงู ุฏู ูุฏู `ReportingLine` ู `EmployeeProfile` ุฑุง ุจูโุฑูุฒุฑุณุงู ูโฺฉูุฏ.  
- ุฏุฑ ุฎุฑูุฌุ ุชุนุฏุงุฏ ุฑูุงุจุท ุณุงุฎุชูโุดุฏูุ ุจูโุฑูุฒุฑุณุงูโุดุฏู ู ุฎุทุงุฏุงุฑ ููุงุด ุฏุงุฏู ูโุดูุฏ.

---

### ๐ ุฌุงฺฏุงู ุฏุฑ ุณุณุชู ุงุฑุฒุงุจ
ุงู ูุงู ููุด ูุงู ุจู ุฏุงุฏูโูุง HR ู ุณุงุฎุชุงุฑ ุงุฑุฒุงุจ ุฏุงุฑุฏ.  
ุงุทูุงุนุงุช ูุงุฑุฏุดุฏู ุงุฒ ุงู ูุงู ูพุงูโุง ุจุฑุง ุณุงุฎุช ููฺฉโูุง ุงุฑุฒุงุจ (`EvaluationLink`) ุฏุฑ ูุงูโูุง ูุงููุฏ `build_links_from_reporting.py` ูุญุณูุจ ูโุดูุฏ.

---

### ๐ ุขุง ูุงุฒู ุงุณุช ูฺฏูโุฏุงุฑ ุดูุฏุ
โ ุจููุ ุงู ูุงู ุถุฑูุฑ ุงุณุช.  
ุฒุฑุง ุจุฑุง ุจูโุฑูุฒุฑุณุงู ุณุฑุน ุฑูุงุจุท ฺฏุฒุงุฑุดโุฏู ุงุฒ HR ู ููฺฏุงูโุณุงุฒ ุงุทูุงุนุงุช ูุฏุฑุช ุจุง ุณุณุชู ุงุฑุฒุงุจ ุนููฺฉุฑุฏ ุงุณุชูุงุฏู ูโุดูุฏ.

๐ก ุฏุฑ ฺู ุดุฑุงุท ูโุชูุงู ุญุฐู ฺฉุฑุฏุ  
ุฏุฑ ุตูุฑุช ฺฉู ุณุงุฎุช ุง ุชุบุฑ ุฑูุงุจุท ฺฏุฒุงุฑุดโุฏู ููุท ุงุฒ ุทุฑู ุฑุงุจุท ฺฉุงุฑุจุฑ ุงุฏูู ุง API ุงูุฌุงู ุดูุฏ ู ูุงุฒ ุจู ุงููพูุฑุช ุงุฒ ุงฺฉุณู ูุจุงุดุฏ.
</div>
      <div class="top"><a href="#top">โ ุจุงุฒฺฏุดุช ุจู ููุฑุณุช</a></div>
    </section>
    
    <section id="file-12" class="card">
      <h2><span class="num">12</span> link_specific_subordinates.py</h2>
      <div class="content">๐ ูุงู: link_specific_subordinates.py
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

### ๐ ุชูุถุญ ฺฉุงุฑฺฉุฑุฏ ูุงู
ุงู ูุงู ฺฉ **management command** ฺฉูฺฉ ุงุณุช ฺฉู ุจุฑุง ุงุฌุงุฏ ุณุฑุน ุฑูุงุจุท ุฎุงุต ุจู ูุฏุฑ ฺฉุงุฑุฎุงูู ู ฺูุฏ ุฒุฑุฏุณุช ูุดุฎุต ุทุฑุงุญ ุดุฏู ุงุณุช.  
ูุฏู ุขู ุงู ุงุณุช ฺฉู ฺูุฏ ฺฉุงุฑููุฏ ุฎุงุต ูุณุชููุงู ุฒุฑ ูุฌููุนูโ ูุฏุฑ ฺฉุงุฑุฎุงูู ูุฑุงุฑ ุจฺฏุฑูุฏุ ุจุฏูู ุชุบุฑ ุฏุฑ ุณุงุฑ ุณุงุฎุชุงุฑูุง.

ูุธูู ฺฉู:
- ุฏุฑุงูุช ููุฑุณุช ุงุฒ ฺฉุฏูุง ูพุฑุณูู ุฒุฑุฏุณุชโูุง ุงุฒ ุทุฑู ุฎุท ูุฑูุงู.  
- ุชูุธู ูุฏุฑ ฺฉุงุฑุฎุงูู ุจูโุนููุงู ุณุฑูพุฑุณุช ูุณุชูู ุขูโูุง ุฏุฑ `EmployeeProfile`.  
- ุงุฌุงุฏ ุง ุจูโุฑูุฒุฑุณุงู ุฑฺฉูุฑุฏูุง `ReportingLine` ูุฑุจูุทู.

๐ ูุญูู ุงุฌุฑุง:
```bash
python manage.py link_specific_subordinates --org "ููุช ุงููุงุณ" --head-pcode 220001 --subs 230014 230018 230055
```
ุฏุฑ ุญุงูุช dry-run:
```bash
python manage.py link_specific_subordinates --dry-run
```

---

### โ๏ธ ูุญูู ุนููฺฉุฑุฏ
1. ุณุงุฒูุงู ู ูุฏุฑ ฺฉุงุฑุฎุงูู ุจุฑ ุงุณุงุณ ูุฑูุฏ ุฏุฑุงูุช ูโุดููุฏ.  
2. ููุฑุณุช ูพุฑุณูู ุฒุฑุฏุณุช ุงุฒ ุขุฑฺฏููุงู `--subs` ุฎูุงูุฏู ูโุดูุฏ.  
3. ุจุฑุง ูุฑ ฺฉุฏ ูพุฑุณูู ูุนุชุจุฑุ ููุฏ `direct_supervisor` ุจุฑุงุจุฑ ุจุง ูุฏุฑ ฺฉุงุฑุฎุงูู ุชูุธู ูโุดูุฏ.  
4. ุฑฺฉูุฑุฏ ูุชูุงุธุฑ ุฏุฑ `ReportingLine` ูุฒ ุณุงุฎุชู ุง ุจูโุฑูุฒุฑุณุงู ูโุดูุฏ.  
5. ฺฏุฒุงุฑุด ููุง ุดุงูู ุชุนุฏุงุฏ ูพุฑููุงูโูุง ู ุฑูุงุจุท ุงุฌุงุฏุดุฏู ุงุณุช.

---

### ๐ง ุณุงุฎุชุงุฑ ู ููุทู ุฏุงุฎู
- ุงุฒ ุชุฑุงฺฉูุด ุงุชูฺฉ ุจุฑุง ุงุฌุฑุง ุงูู ุนููุงุช ุงุณุชูุงุฏู ูโุดูุฏ.  
- ุชุบุฑุงุช ููุท ุฑู ฺฉุงุฑฺฉูุงู ูุดุฎุตโุดุฏู ุงุนูุงู ูโุดูุฏ ู ุณุงุฑ ุฏุงุฏูโูุง ุจุฏูู ุชุบุฑ ุจุงู ูโูุงููุฏ.  
- ุฏุฑ ุญุงูุช dry-run ูฺ ุชุบุฑ ุฐุฎุฑู ููโุดูุฏ.

---

### ๐ ุฌุงฺฏุงู ุฏุฑ ุณุณุชู ุงุฑุฒุงุจ
ุงู ุฏุณุชูุฑ ุงุจุฒุงุฑ ฺฉูฺฉ ุฏุฑ ุดุฑุงุท ุฎุงุต ุงุณุชุ ุจุฑุง ูุซุงู ููุช ฺูุฏ ฺฉุงุฑููุฏ ุจุงุฏ ูููุชุงู ุง ุจูโุตูุฑุช ุฏุณุช ุฒุฑ ูุธุฑ ูุฏุฑ ฺฉุงุฑุฎุงูู ูุฑุงุฑ ุจฺฏุฑูุฏ.  
ุฏุฑ ฺฉูุงุฑ ูุงูโูุง ูุงููุฏ `build_evaluation_links.py` ู `backfill_reporting_lines.py` ุจูโุนููุงู ุงุจุฒุงุฑ ุงุตูุงุญ ุนูู ูโฺฉูุฏ.

---

### ๐ ุขุง ูุงุฒู ุงุณุช ูฺฏูโุฏุงุฑ ุดูุฏุ
โ ุจููุ ูฺฏูโุฏุงุฑ ุขู ุชูุตู ูโุดูุฏ.  
ุฒุฑุง ุฏุฑ ุณูุงุฑููุง ุงุถุทุฑุงุฑ ุง ุงุตูุงุญ ุฏุงุฏูโูุง ุจุณุงุฑ ููุฏ ุงุณุช ู ูโุชูุงูุฏ ุณุงุฎุชุงุฑ ุณุงุฒูุงู ุฑุง ุจุฏูู ูุงุฒ ุจู ุงููพูุฑุช ุฌุฏุฏ ุงุตูุงุญ ฺฉูุฏ.

๐ก ุฏุฑ ฺู ุดุฑุงุท ูโุชูุงู ุญุฐู ฺฉุฑุฏุ  
ุงฺฏุฑ ุชูุงู ุชุบุฑุงุช ุฑูุงุจุท ูุฏุฑุช ููุท ุงุฒ ุทุฑู ูุงูโูุง HR ุง ุฑุงุจุท ฺฉุงุฑุจุฑ ุงูุฌุงู ุดูุฏ ู ูุงุฒ ุจู ุงุตูุงุญุงุช ุฏุณุช ูุจุงุดุฏ.
</div>
      <div class="top"><a href="#top">โ ุจุงุฒฺฏุดุช ุจู ููุฑุณุช</a></div>
    </section>
    
    <section id="file-13" class="card">
      <h2><span class="num">13</span> load_jobroles_from_excel.py</h2>
      <div class="content">๐ ูุงู: load_jobroles_from_excel.py
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

### ๐ ุชูุถุญ ฺฉุงุฑฺฉุฑุฏ ูุงู
ุงู ูุงู ฺฉ **management command** ุณุงุฏู ุงุณุช ฺฉู ุจุฑุง ุจุงุฑฺฏุฐุงุฑ (Load) ููุดโูุง ุดุบู (`JobRole`) ุงุฒ ูุงู ุงฺฉุณู ุทุฑุงุญ ุดุฏู ุงุณุช.  
ูุฏู ุขู ุงุณุชุฎุฑุงุฌ ู ุงุฌุงุฏ ุชูุงู ุนููุงูโูุง ุดุบู ููุฌูุฏ ุฏุฑ ุฏุงุฏูโูุง HR ุงุณุช.

ูุธูู ฺฉู:
- ุฎูุงูุฏู ุณุชูู ูุฑุจูุท ุจู ููุด ุดุบู (`job_role`) ุงุฒ ูุงู Excel.  
- ุงุฌุงุฏ ุฑฺฉูุฑุฏูุง ุฌุฏุฏ ุฏุฑ ูุฏู `JobRole` ุฏุฑ ุตูุฑุช ูุจูุฏ ุนููุงู ุดุบู.  
- ุนุฏู ุชุบุฑ ููุฏ `code` ุชุง ุจูโุตูุฑุช ุฏุณุช ุชูุธู ุดูุฏ.

๐ ูุญูู ุงุฌุฑุง:
```bash
python manage.py load_jobroles_from_excel
```
ุฏุฑ ุตูุฑุช ูุงุฒ ุจู ุชุบุฑ ูุณุฑ ูุงู ุง ุดุชุ ูพุงุฑุงูุชุฑูุง ุฏุฑ ุงุจุชุฏุง ูุงู ุชูุธู ูโุดููุฏ:
```python
EXCEL_PATH  = r"D:\performance_eval\employees_normalized.xlsx"
SHEET_NAME  = "Sheet1"
ROLE_COL    = "job_role"
```

---

### โ๏ธ ูุญูู ุนููฺฉุฑุฏ
1. ูุงู ุงฺฉุณู ุจุง ุงุณุชูุงุฏู ุงุฒ `pandas` ุฎูุงูุฏู ูโุดูุฏ.  
2. ุณุชูู `job_role` ุจุฑุฑุณ ูโฺฏุฑุฏุฏ ุชุง ุชฺฉุฑุงุฑูุง ู ููุงุฏุฑ ุฎุงู ุญุฐู ุดููุฏ.  
3. ุจุฑุง ูุฑ ููุด ููุญุตุฑุจูโูุฑุฏุ ุฏุฑ ูุฏู `JobRole` ฺฉ ุฑฺฉูุฑุฏ ุฌุฏุฏ ุณุงุฎุชู ูโุดูุฏ (ุฏุฑ ุตูุฑุช ุนุฏู ูุฌูุฏ).  
4. ฺฏุฒุงุฑุด ุดุงูู ุชุนุฏุงุฏ ฺฉู ููุดโูุง ู ุชุนุฏุงุฏ ููุดโูุง ุชุงุฒูโุณุงุฎุชูโุดุฏู ฺุงูพ ูโุดูุฏ.

---

### ๐ง ุณุงุฎุชุงุฑ ู ููุทู ุฏุงุฎู
- ุจุฑุง ูุฑ ุนููุงู ุงุฒ `get_or_create` ุงุณุชูุงุฏู ูโุดูุฏ ุชุง ุงุฒ ุงุฌุงุฏ ุชฺฉุฑุงุฑ ุฌููฺฏุฑ ุดูุฏ.  
- ูุงู ููุดโูุง ูพุด ุงุฒ ุฐุฎุฑู ูพุงฺฉโุณุงุฒ ู ูุฑูุงูโุณุงุฒ ูโุดููุฏ.  
- ุงุฌุฑุง ุจุณุงุฑ ุณุจฺฉ ู ุณุฑุน ุงุณุช.

---

### ๐ ุฌุงฺฏุงู ุฏุฑ ุณุณุชู ุงุฑุฒุงุจ
ุงู ุฏุณุชูุฑ ุงููู ฺฏุงู ุฏุฑ ุณุงุฎุช ุณุงุฎุชุงุฑ ุดุบู ุณุงุฒูุงู ุงุณุช.  
ุฏุงุฏูโูุง ุชููุฏุดุฏู ุชูุณุท ุขู ุฏุฑ ูุฑุงุญู ุจุนุฏุ ุจูโูฺู ุฏุฑ ูุงูโูุง  
`import_jobroles_with_units.py` ู `sync_jobrole_units_from_excel.py` ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ูโฺฏุฑูุฏ.

---

### ๐ ุขุง ูุงุฒู ุงุณุช ูฺฏูโุฏุงุฑ ุดูุฏุ
โ ุจููุ ุจูุชุฑ ุงุณุช ูฺฏูโุฏุงุฑ ุดูุฏ.  
ุงู ุงุจุฒุงุฑ ุจุฑุง ููฺฏุงูโุณุงุฒ ููุดโูุง ุฌุฏุฏ ุงุฒ HR ุจูโุตูุฑุช ุณุฑุน ู ุงูู ฺฉุงุฑุจุฑุฏ ุฏุงุฑุฏ.

๐ก ุฏุฑ ฺู ุดุฑุงุท ูโุชูุงู ุญุฐู ฺฉุฑุฏุ  
ุงฺฏุฑ ููุดโูุง ุดุบู ููุท ุงุฒ ุทุฑู ูพูู ุงุฏูู ูุฏุฑุช ุดููุฏ ู ูฺ ูุงู HR ุงฺฉุณู ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏุ ุญุฐู ุขู ููฺฉู ุงุณุช.
</div>
      <div class="top"><a href="#top">โ ุจุงุฒฺฏุดุช ุจู ููุฑุณุช</a></div>
    </section>
    
    <section id="file-14" class="card">
      <h2><span class="num">14</span> rebuild_hierarchy_from_excel.py</h2>
      <div class="content">๐ ูุงู: rebuild_hierarchy_from_excel.py
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

### ๐ ุชูุถุญ ฺฉุงุฑฺฉุฑุฏ ูุงู
ุงู ูุงู ฺฉ ุงุฒ ุฏุณุชูุฑุงุช ูพุดุฑูุชู ุจุฑุง ุจุงุฒุณุงุฒ ฺฉุงูู ุณูุณููโูุฑุงุชุจ ุณุงุฒูุงู ุงุฒ ุฑู ุฏุงุฏูโูุง Excel ุงุณุช.  
ูุฏู ุขู ุชูุธู ุฏูู ุฑูุงุจุท ูุฏุฑุช (ูุฏุฑ ูุงุญุฏุ ุฑุฆุณุ ุณุฑูพุฑุณุช ู ูพุฑุณูู) ุจุฑ ุงุณุงุณ ฺฉุฏ ูุงุญุฏ (`unit_code`) ู ุณุทุญ ููุด (`role_level`) ุงุณุช.

ูุธูู ฺฉู:
- ุจุงุฒุณุงุฒ ฺฉู ุณุงุฎุชุงุฑ ุณุงุฒูุงู ุจุฑ ุงุณุงุณ ุฏุงุฏูโูุง HR.  
- ุชูุธู `Unit.manager`ุ `direct_supervisor` ู `section_head` ุจุฑุง ุชูุงู ฺฉุงุฑฺฉูุงู.  
- ูพุดุชุจุงู ุงุฒ ููุงูู ุฎุงุต ูุงุญุฏูุง ูุงููุฏ ูุฌุณุชฺฉุ ูุงู ู ุญุฑุงุณุช.

๐ ูุญูู ุงุฌุฑุง:
```bash
python manage.py rebuild_hierarchy_from_excel employees_normalized.xlsx --org "ููุช ุงููุงุณ" --org-head 220001
```
ฺฏุฒููโูุง:
- `--dry-run` : ููุท ฺฏุฒุงุฑุด ุชููุฏ ูโฺฉูุฏ ุจุฏูู ุงุนูุงู ุชุบุฑุงุช.  
- `--org` : ุชุนู ุณุงุฒูุงู ูุฏู.  
- `--org-head` : ุชุนู ูุฏุฑ ฺฉุงุฑุฎุงูู.

---

### โ๏ธ ูุญูู ุนููฺฉุฑุฏ
1. ูุงู ุงฺฉุณู ุฎูุงูุฏู ูโุดูุฏ ู ุณุชููโูุง ฺฉูุฏ (`organization`, `unit_code`, `personnel_code`, `role_level`, `team_code`) ุงุณุชุฎุฑุงุฌ ูโุดููุฏ.  
2. ููุดโูุง ูุฑูุงูโุณุงุฒ ู ุณุทุญ ููุดโูุง ุจู ฺฉุฏูุง นฐฐ ุชุง นฐด ุง ฐฐฐ ุชุง ฐฐด ูฺฏุงุดุช ูโุดููุฏ.  
3. ููุงูู ุฎุงุต ุงุฒ ุซุงุจุชโูุง ุจุงูุง ูุงู (`UNIT_RULES`) ุฎูุงูุฏู ูโุดููุฏ.  
4. ุจุฑุง ูุฑ ูุงุญุฏ:
   - ูุฏุฑ ูุงุญุฏ ู ุฑุฆุณ ูุดุฎุต ูโุดูุฏ.
   - ูพุฑุณูู ุฒุฑ ูุฏุฑ ุง ุฑุฆุณ ูุฑุจูุทู ูุฑุงุฑ ูโฺฏุฑูุฏ.
5. ุฏุฑ ูพุงุงู ฺฏุฒุงุฑุด ุงุฒ ุชุนุฏุงุฏ ุฑฺฉูุฑุฏูุง ุชุบุฑโฺฉุฑุฏู ฺุงูพ ูโุดูุฏ.

---

### ๐ง ุณุงุฎุชุงุฑ ู ููุทู ุฏุงุฎู
- ุงุฒ ุชุฑุงฺฉูุด ุงุชูฺฉ ุจุฑุง ุญูุธ ุงูุณุฌุงู ุฏุงุฏูโูุง ุงุณุชูุงุฏู ูโุดูุฏ.  
- ุชูุงู ููุดโูุง ู ูุงุญุฏูุง ุจุฑ ุงุณุงุณ ุงูููุช ู ุณุทุญ ููุด ุฏุณุชูโุจูุฏ ูโุดููุฏ.  
- ุงูุนุทุงูโูพุฐุฑ ุจุงูุง ุจุฑุง ูุงุญุฏูุง ุฎุงุต ุจุง ุณุงุฎุชุงุฑ ูุชูุงูุช ุฏุงุฑุฏ.

---

### ๐ ุฌุงฺฏุงู ุฏุฑ ุณุณุชู ุงุฑุฒุงุจ
ุงู ูุงู ููุด ูุฑฺฉุฒ ุฏุฑ ุณุงุฎุช ู ูฺฏูโุฏุงุฑ ุณูุณููโูุฑุงุชุจ ุณุงุฒูุงู ุฏุงุฑุฏ.  
ุฏุงุฏูโูุง ุขู ูพุงูโุง ุจุฑุง ุงุฌุฑุง ุฏุณุชูุฑุงุช ุจุนุฏ ูุงููุฏ  
`set_unit_managers_from_codes.py`, `set_direct_supervisors_from_units.py` ู `backfill_reporting_lines.py` ูุณุชูุฏ.

---

### ๐ ุขุง ูุงุฒู ุงุณุช ูฺฏูโุฏุงุฑ ุดูุฏุ
โ ุจููุ ูฺฏูโุฏุงุฑ ุขู ฺฉุงููุงู ุถุฑูุฑ ุงุณุช.  
ุฒุฑุง ุงู ูุงู ูุฑุฌุน ุงุตู ุจุฑุง ุจุงุฒุณุงุฒ ุณุงุฎุชุงุฑ ุณุงุฒูุงู ู ุฑูุงุจุท ูุฏุฑุช ุงุณุช.

๐ก ุฏุฑ ฺู ุดุฑุงุท ูโุชูุงู ุญุฐู ฺฉุฑุฏุ  
ููุท ุงฺฏุฑ ุณุงุฎุชุงุฑ ุณูุณููโูุฑุงุชุจ ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุงุฒ ุทุฑู API ุง ุณุณุชู HR ุฎุงุฑุฌ ุชููุฏ ุดูุฏ.
</div>
      <div class="top"><a href="#top">โ ุจุงุฒฺฏุดุช ุจู ููุฑุณุช</a></div>
    </section>
    
    <section id="file-15" class="card">
      <h2><span class="num">15</span> set_direct_supervisors_from_units.py</h2>
      <div class="content">๐ ูุงู: set_direct_supervisors_from_units.py
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

### ๐ ุชูุถุญ ฺฉุงุฑฺฉุฑุฏ ูุงู
ุงู ูุงู ฺฉ **management command** ุงุณุช ฺฉู ุจุฑุง ุชูุธู ุฎูุฏฺฉุงุฑ ููุฏ `direct_supervisor` ฺฉุงุฑฺฉูุงู ุทุฑุงุญ ุดุฏู ุงุณุช.  
ูุฏู ุขู ุงู ุงุณุช ฺฉู ุจุฑุง ูุฑ ฺฉุงุฑููุฏุ ูุฏุฑ ูุณุชูู ุงุฒ ููุฏ `Unit.manager` ููุงู ูุงุญุฏ ุชุนู ุดูุฏ.

ูุธูู ฺฉู:
- ุจุฑุฑุณ ุชูุงู ฺฉุงุฑฺฉูุงู ุฏุฑ ูุฑ ูุงุญุฏ.  
- ุฏุฑ ุตูุฑุช ูุฌูุฏ ูุฏุฑ ุจุฑุง ุขู ูุงุญุฏุ ุชูุธู ููุงู ูุฑุฏ ุจูโุนููุงู ูุฏุฑ ูุณุชูู ฺฉุงุฑฺฉูุงู.  
- ูพุดุชุจุงู ุงุฒ ฺฏุฒููโูุง ููุชุฑ ูุงููุฏ `--org` ู `--only-null`.

๐ ูุญูู ุงุฌุฑุง:
```bash
python manage.py set_direct_supervisors_from_units --org "ููุช ุงููุงุณ" --only-null
```
ุฏุฑ ุญุงูุช ุขุฒูุงุด:
```bash
python manage.py set_direct_supervisors_from_units --dry-run
```

---

### โ๏ธ ูุญูู ุนููฺฉุฑุฏ
1. ูุงุญุฏูุง ุงุฒ ูุฏู `Unit` ุฎูุงูุฏู ูโุดููุฏ.  
2. ุจุฑุง ูุฑ ูุงุญุฏ ฺฉู ูุฏุฑ ุฏุงุฑุฏุ ููู ฺฉุงุฑฺฉูุงู ุขู ูุงุญุฏ ูุงฺฉุด ูโุดููุฏ.  
3. ุงฺฏุฑ ฺฉุงุฑููุฏ ุฎูุฏุด ูุฏุฑ ููุงู ูุงุญุฏ ูุจุงุดุฏุ ููุฏ `direct_supervisor` ุงู ุจุฑุงุจุฑ ูุฏุฑ ูุงุญุฏ ุชูุธู ูโุดูุฏ.  
4. ุฏุฑ ุญุงูุช `--only-null` ููุท ุฑฺฉูุฑุฏูุง ฺฉู ูููุฒ ูุฏุฑ ูุณุชูู ูุฏุงุฑูุฏ ุจูโุฑูุฒุฑุณุงู ูโุดููุฏ.  
5. ุฏุฑ ูพุงุงู ฺฏุฒุงุฑุด ุงุฒ ุฑฺฉูุฑุฏูุง ุจูโุฑูุฒุฑุณุงูโุดุฏู ููุงุด ุฏุงุฏู ูโุดูุฏ.

---

### ๐ง ุณุงุฎุชุงุฑ ู ููุทู ุฏุงุฎู
- ุนููุงุช ุจูโุตูุฑุช ฺฏุฑูู (bulk update) ุงูุฌุงู ูโุดูุฏ ุชุง ุนููฺฉุฑุฏ ุจููู ุจุงุดุฏ.  
- ุงุฒ ุชุฑุงฺฉูุด ุงุชูฺฉ ุจุฑุง ุงุทููุงู ุงุฒ ุตุญุช ุฏุงุฏูโูุง ุงุณุชูุงุฏู ูโุดูุฏ.  
- ฺฏุฒููโ `--exclude-units` ุงุฌุงุฒู ูโุฏูุฏ ุจุฑุฎ ูุงุญุฏูุง ุงุฒ ูุฑุขูุฏ ุญุฐู ุดููุฏ.

---

### ๐ ุฌุงฺฏุงู ุฏุฑ ุณุณุชู ุงุฑุฒุงุจ
ุงู ูุงู ููุด ููู ุฏุฑ ูุฑุญููโ ุชูุธู ุฑูุงุจุท ุงูููโ ูุฏุฑุช ุฏุงุฑุฏ.  
ุจุนุฏ ุงุฒ ุชุนู ูุฏุฑุงู ูุงุญุฏ ุชูุณุท ุฏุณุชูุฑ `set_unit_managers_from_codes.py`ุ  
ุงู ุฏุณุชูุฑ ุชูุงู ฺฉุงุฑฺฉูุงู ุฒุฑูุฌููุนู ุฑุง ุจู ูุฏุฑ ูุฑุจูุทู ูุชุตู ูโฺฉูุฏ.

---

### ๐ ุขุง ูุงุฒู ุงุณุช ูฺฏูโุฏุงุฑ ุดูุฏุ
โ ุจููุ ูฺฏูโุฏุงุฑ ุขู ุถุฑูุฑ ุงุณุช.  
ุฒุฑุง ุจุฑุง ููุงููฺฏโุณุงุฒ ุณุฑุน ุฑูุงุจุท ูุฏุฑ ูุณุชูู ูพุณ ุงุฒ ูุฑ ุงููพูุฑุช ุฏุงุฏู ููุฑุฏ ูุงุฒ ุงุณุช.

๐ก ุฏุฑ ฺู ุดุฑุงุท ูโุชูุงู ุญุฐู ฺฉุฑุฏุ  
ุฏุฑ ุตูุฑุช ฺฉู ุณุงุฎุชุงุฑ ูุฏุฑุช ููุดู ุงุฒ ุทุฑู ุจุงุฒุณุงุฒ ุฎูุฏฺฉุงุฑ (`rebuild_hierarchy_from_excel.py`) ุงูุฌุงู ุดูุฏ ู ูุงุฒ ุจู ุชูุธู ุฏุณุช ูุจุงุดุฏ.
</div>
      <div class="top"><a href="#top">โ ุจุงุฒฺฏุดุช ุจู ููุฑุณุช</a></div>
    </section>
    
    <section id="file-16" class="card">
      <h2><span class="num">16</span> set_unit_managers_from_codes.py</h2>
      <div class="content">๐ ูุงู: set_unit_managers_from_codes.py
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

### ๐ ุชูุถุญ ฺฉุงุฑฺฉุฑุฏ ูุงู
ุงู ูุงู ฺฉ **management command** ุงุณุช ฺฉู ุจุฑุง ุชูุธู ููุฏ `Unit.manager` ุงุฒ ุฑู ูุงู ุงฺฉุณู ุทุฑุงุญ ุดุฏู ุงุณุช.  
ูุฏู ุขู ุดูุงุณุง ูุฏุฑุงู ูุงุญุฏูุง ุงุฒ ุฏุงุฏูโูุง HR ุจุฑ ุงุณุงุณ `role_level` ู `team_code` ุงุณุช.

ูุธูู ฺฉู:
- ุฎูุงูุฏู ุฏุงุฏูโูุง ุงุฒ ุงฺฉุณู ู ุงูุชู ฺฉุงูุฏุฏุง ูุฏุฑ ุจุฑุง ูุฑ ูุงุญุฏ.  
- ุงูุชุฎุงุจ ูุฏุฑ ุงุตู (ุจุง ฺฉูุชุฑู `team_code`).  
- ุชูุธู ุขู ฺฉุงุฑููุฏ ุจูโุนููุงู `Unit.manager` ุฏุฑ ุฏุชุงุจุณ.

๐ ูุญูู ุงุฌุฑุง:
```bash
python manage.py set_unit_managers_from_codes employees_normalized.xlsx --org "ููุช ุงููุงุณ"
```
ุฏุฑ ุญุงูุช dry-run:
```bash
python manage.py set_unit_managers_from_codes employees_normalized.xlsx --org "ููุช ุงููุงุณ" --dry-run
```

---

### โ๏ธ ูุญูู ุนููฺฉุฑุฏ
1. ูุงู ุงฺฉุณู ุฎูุงูุฏู ูโุดูุฏ ู ุณุชููโูุง `organization`, `unit`, `personnel_code`, `role_level`, `team_code` ุจุฑุฑุณ ูโุดููุฏ.  
2. ุฑุฏูโูุง ุจุง ููุด ูุฏุฑ ูุงุญุฏ (UNIT_MGR = 901 ุง 001) ุงูุชุฎุงุจ ูโุดููุฏ.  
3. ุงุฒ ูุงู ฺูุฏ ฺฉุงูุฏุฏ ุจุฑุง ฺฉ ูุงุญุฏุ ูุฑุฏ ุจุง ฺฉูุชุฑู `team_code` ุงูุชุฎุงุจ ูโุดูุฏ.  
4. ุฑฺฉูุฑุฏ `Unit.manager` ุจุฑุง ูุฑ ูุงุญุฏ ุจูโุฑูุฒุฑุณุงู ูโุดูุฏ.  
5. ุฏุฑ ูพุงุงู ฺฏุฒุงุฑุด ุดุงูู ุชุนุฏุงุฏ ูุฏุฑุงู ูุงุญุฏูุง ุจูโุฑูุฒุดุฏู ฺุงูพ ูโุดูุฏ.

---

### ๐ง ุณุงุฎุชุงุฑ ู ููุทู ุฏุงุฎู
- ุงุฒ `pandas` ุจุฑุง ูพุฑุฏุงุฒุด ุฏุงุฏูโูุง ู ุงุฒ ุชุฑุงฺฉูุด ุงุชูฺฉ ุจุฑุง ุงุทููุงู ุงุฒ ฺฉูพุงุฑฺฺฏ ุฏุงุฏูโูุง ุงุณุชูุงุฏู ูโุดูุฏ.  
- ุฏุฑ ุตูุฑุช ุนุฏู ูุฌูุฏ ฺฉุงุฑุจุฑ ุง ูุงุญุฏุ ุฏุฑ ฺฏุฒุงุฑุด ููุง ุจูโุนููุงู Missing ฺุงูพ ูโุดูุฏ.  
- ุงูุชุฎุงุจ ูุฏุฑ ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุจุฑ ุงุณุงุณ ุญุฏุงูู `team_code` ุงูุฌุงู ูโุดูุฏ.

---

### ๐ ุฌุงฺฏุงู ุฏุฑ ุณุณุชู ุงุฑุฒุงุจ
ุงู ูุงู ฺฉ ุงุฒ ูุฑุงุญู ฺฉูุฏ ุฏุฑ ูุฑุขูุฏ ุจุงุฒุณุงุฒ ุณุงุฎุชุงุฑ ุณุงุฒูุงู ุงุณุช.  
ุฎุฑูุฌ ุขู ูุจูุง ุงุฌุฑุง `set_direct_supervisors_from_units.py` ุจุฑุง ุงุชุตุงู ุณุงุฑ ฺฉุงุฑฺฉูุงู ุจู ูุฏุฑุงู ูุงุญุฏูุงุณุช.

---

### ๐ ุขุง ูุงุฒู ุงุณุช ูฺฏูโุฏุงุฑ ุดูุฏุ
โ ุจููุ ูฺฏูโุฏุงุฑ ุขู ุชูุตู ูโุดูุฏ.  
ุฒุฑุง ุงู ูุงู ูุณุฆูู ุชูุธู ุฏูู ูุฏุฑุงู ูุงุญุฏ ุงุฒ ุฏุงุฏูโูุง HR ุงุณุช ู ูพุงูโ ุณูุณููโูุฑุงุชุจ ุณุงุฒูุงู ุฑุง ุชุดฺฉู ูโุฏูุฏ.

๐ก ุฏุฑ ฺู ุดุฑุงุท ูโุชูุงู ุญุฐู ฺฉุฑุฏุ  
ุงฺฏุฑ ฺฉู ูุฑุขูุฏ ุชุดุฎุต ูุฏุฑุงู ุฏุฑ ูุงู `rebuild_hierarchy_from_excel.py` ุงุฏุบุงู ุดูุฏ ู ูุงุฒ ุจู ุงุฌุฑุง ุฌุฏุงฺฏุงูู ูุจุงุดุฏ.
</div>
      <div class="top"><a href="#top">โ ุจุงุฒฺฏุดุช ุจู ููุฑุณุช</a></div>
    </section>
    
    <section id="file-17" class="card">
      <h2><span class="num">17</span> set_unit_managers_from_roles.py</h2>
      <div class="content">๐ ูุงู: set_unit_managers_from_roles.py
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

### ๐ ุชูุถุญ ฺฉุงุฑฺฉุฑุฏ ูุงู
ุงู ูุงู ฺฉ **management command** ุชุญูู ุงุณุช ฺฉู ุจุฑุง ุดูุงุณุง ุฎูุฏฺฉุงุฑ ูุฏุฑุงู ูุงุญุฏูุง (`Unit.manager`) ุงุฒ ุทุฑู ุนููุงู ุดุบู (`job_role.name`) ุทุฑุงุญ ุดุฏู ุงุณุช.  
ูุฏู ุขู ุงูุชู ูุฏุฑุงู ูุงูุน ุจุฏูู ูุงุฒ ุจู role_level ุง ูุงู ุงฺฉุณู ุงุณุช.

ูุธูู ฺฉู:
- ุจุฑุฑุณ ุนููุงูโูุง ุดุบู (`job_role`) ู ุงูุชู ุงูุฑุงุฏ ฺฉู ููุด ูุฏุฑุช ุฏุงุฑูุฏ.  
- ุงูุชุฎุงุจ ุจูุชุฑู ฺฉุงูุฏุฏ ุจูโุนููุงู ูุฏุฑ ูุงุญุฏ ุจุฑ ุงุณุงุณ ุงูฺฏู ุงูุชุงุฒุฏู ูุชู.  
- ูพุดุชุจุงู ุงุฒ ุงูุชุฎุงุจ ุฎูุฏฺฉุงุฑ ู ฺฏุฒููโ ุชุฑุฌุญ (`--prefer`).

๐ ูุญูู ุงุฌุฑุง:
```bash
python manage.py set_unit_managers_from_roles --org "ููุช ุงููุงุณ" --prefer "ูุฏุฑ ูุงุญุฏ"
```
ุฏุฑ ุญุงูุช dry-run:
```bash
python manage.py set_unit_managers_from_roles --org "ููุช ุงููุงุณ" --dry-run
```

---

### โ๏ธ ูุญูู ุนููฺฉุฑุฏ
1. ูููโ ูุงุญุฏูุง (`Unit`) ุจุงุฑฺฏุฐุงุฑ ูโุดููุฏ (ุจุฑ ุงุณุงุณ ูพุงุฑุงูุชุฑ `--org`).  
2. ุจุฑุง ูุฑ ูุงุญุฏุ ฺฉุงุฑฺฉูุงู ุจุง ุนููุงู ุดุบู ูุดุงุจู "ูุฏุฑ" ุง "manager" ุดูุงุณุง ูโุดููุฏ.  
3. ุจู ูุฑ ุนููุงู ุงูุชุงุฒ ุฏุงุฏู ูโุดูุฏ ุจุฑ ุงุณุงุณ ุชุทุงุจู ุจุง ฺฉูุฏูุงฺูโูุง:
   - ุดุงูู "ูุฏุฑ" โ +10  
   - ุดุงูู "ูุงุญุฏ" โ +3  
   - ุดุงูู "ูุฏุฑ ูุงุญุฏ" โ +5  
   - ุดุงูู "ุณุฑูพุฑุณุช" ุง "ุฑุฆุณ" โ -10  
4. ูุฑุฏ ุจุง ุจุงูุงุชุฑู ุงูุชุงุฒ ุงูุชุฎุงุจ ู ุจูโุนููุงู `Unit.manager` ุซุจุช ูโุดูุฏ.  
5. ุงฺฏุฑ ฺูุฏ ููุฑ ุงูุชุงุฒ ูุดุงุจู ุฏุงุดุชู ุจุงุดูุฏุ ุฏุฑ ุตูุฑุช ูุจูุฏ `--prefer` ุตุฑูโูุธุฑ ูโุดูุฏ.

---

### ๐ง ุณุงุฎุชุงุฑ ู ููุทู ุฏุงุฎู
- ุงุฒ ุงูฺฏูุฑุชู ุงูุชุงุฒุฏู ุณุงุฏู ู ูุงุจู ุชูุณุนู ุงุณุชูุงุฏู ูโฺฉูุฏ.  
- ุฏุฑ ุตูุฑุช ูุฌูุฏ ambiguityุ ฺฏุฒุงุฑุด ุฎุทุง ฺุงูพ ูโุดูุฏ ุชุง ุงุตูุงุญ ุฏุณุช ุงูุฌุงู ุดูุฏ.  
- ูพุดุชุจุงู ฺฉุงูู ุงุฒ ุญุงูุช dry-run ุจุฑุง ุชุณุช ูุจู ุงุฒ ุงุนูุงู ููุง.

---

### ๐ ุฌุงฺฏุงู ุฏุฑ ุณุณุชู ุงุฑุฒุงุจ
ุงู ูุงู ุงุจุฒุงุฑ ุชุญูู ู ูฺฉูู ูุงู `set_unit_managers_from_codes.py` ุงุณุช.  
ุฏุฑ ุณุงุฒูุงูโูุง ฺฉู role_level ุฏุฑ ุฏุงุฏูโูุง HR ุซุจุช ูุดุฏูุ ุงู ุฏุณุชูุฑ ุฑุงู ููุดููุฏ ุจุฑุง ุดูุงุณุง ูุฏุฑุงู ูุงุญุฏูุง ูุฑุงูู ูโฺฉูุฏ.

---

### ๐ ุขุง ูุงุฒู ุงุณุช ูฺฏูโุฏุงุฑ ุดูุฏุ
โ ุจููุ ูฺฏูโุฏุงุฑ ุขู ุชูุตู ูโุดูุฏ.  
ุฒุฑุง ุฏุฑ ููุงูุน ฺฉู ูุงูโูุง HR ูุงูุต ูุณุชูุฏ ุง ูุงุฒ ุจู ุงุนุชุจุงุฑุณูุฌ ุฏุงุฏูโูุง ูุฌูุฏ ุฏุงุฑุฏุ ุจุณุงุฑ ููุฏ ุงุณุช.

๐ก ุฏุฑ ฺู ุดุฑุงุท ูโุชูุงู ุญุฐู ฺฉุฑุฏุ  
ุงฺฏุฑ ููุดู role_level ู ุฏุงุฏูโูุง ุณุงุฎุชุงุฑ ฺฉุงูู ุงุฒ HR ุฏุฑ ุฏุณุชุฑุณ ุจุงุดูุฏ ู ูุงุฒ ุจู ุชุญูู ุนููุงู ุดุบู ูุจุงุดุฏ.
</div>
      <div class="top"><a href="#top">โ ุจุงุฒฺฏุดุช ุจู ููุฑุณุช</a></div>
    </section>
    
    <section id="file-18" class="card">
      <h2><span class="num">18</span> sync_jobrole_units_from_excel.py</h2>
      <div class="content">๐ ูุงู: sync_jobrole_units_from_excel.py
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

### ๐ ุชูุถุญ ฺฉุงุฑฺฉุฑุฏ ูุงู
ุงู ูุงู ฺฉ **management command** ุจุฑุง ููฺฏุงูโุณุงุฒ ุงุฑุชุจุงุท ุจู ููุดโูุง ุดุบู (`JobRole`) ู ูุงุญุฏูุง (`Unit`) ุงุฒ ุฏุงุฏูโูุง Excel ุงุณุช.  
ูุฏู ุขู ุจูโุฑูุฒุฑุณุงู ุฑุงุจุทูโ ManyToMany ุจู ููุดโูุง ู ูุงุญุฏูุง ุจุฑ ุงุณุงุณ ุฏุงุฏูโูุง ูุงูุน HR ุงุณุช.

ูุธูู ฺฉู:
- ุฎูุงูุฏู ุณุชููโูุง `job_role` ู `unit_code` ุงุฒ ุงฺฉุณู.  
- ุจูโุฑูุฒุฑุณุงู ููุฏ ManyToMany ุจู `JobRole` ู `Unit`.  
- ฺฏุฒุงุฑุด ุฑูุงุจุท ูุงูุต ุง ูุงุญุฏูุง ูุงููุฌูุฏ.

๐ ูุญูู ุงุฌุฑุง:
```bash
python manage.py sync_jobrole_units_from_excel employees_normalized.xlsx
```
ุฏุฑ ุญุงูุช dry-run:
```bash
python manage.py sync_jobrole_units_from_excel employees_normalized.xlsx --dry-run
```

---

### โ๏ธ ูุญูู ุนููฺฉุฑุฏ
1. ูุงู ุงฺฉุณู ุงุฒ ูุณุฑ ูุดุฎุตโุดุฏู ุฎูุงูุฏู ูโุดูุฏ.  
2. ุชูุงู ุชุฑฺฉุจโูุง ฺฉุชุง ุงุฒ `(job_role, unit_code)` ุงุณุชุฎุฑุงุฌ ูโุดููุฏ.  
3. ุจุฑุง ูุฑ `JobRole`ุ ูุณุช ูุงุญุฏูุง ูุฑุชุจุท ุชุนู ู ุฏุฑ ููุฏ `units` ุฐุฎุฑู ูโุดูุฏ.  
4. ุงฺฏุฑ ูุงุญุฏ ุฏุฑ ุฏุชุงุจุณ ููุฌูุฏ ูุจุงุดุฏุ ุฏุฑ ฺฏุฒุงุฑุด ุฎุฑูุฌ ุจูโุนููุงู Missing ฺุงูพ ูโุดูุฏ.

---

### ๐ง ุณุงุฎุชุงุฑ ู ููุทู ุฏุงุฎู
- ุงุฒ ฺฉุชุงุจุฎุงููโ `pandas` ุจุฑุง ุงุณุชุฎุฑุงุฌ ุฏุงุฏูโูุง ุงุณุชูุงุฏู ูโฺฉูุฏ.  
- ุชูุงู ุนููุงุช ุฏุฑ ฺฉ ุชุฑุงฺฉูุด ุงูุฌุงู ูโุดูุฏ ุชุง ููฺฏุงูโุณุงุฒ ูุงูุต ุฑุฎ ูุฏูุฏ.  
- ุฑูุงุจุท ูุจู ุฌุงฺฏุฒู ุฑูุงุจุท ุฌุฏุฏ ูโุดููุฏ (Full Sync).

---

### ๐ ุฌุงฺฏุงู ุฏุฑ ุณุณุชู ุงุฑุฒุงุจ
ุงู ูุงู ูพุณ ุงุฒ ุณุงุฎุช ููุดโูุง ุดุบู (`load_jobroles_from_excel.py`) ู ูุงุญุฏูุง (`import_employees.py`) ุงุฌุฑุง ูโุดูุฏ.  
ุงุทูุงุนุงุช ุญุงุตู ุงุฒ ุขู ุจุฑุง ุงุฎุชุตุงุต ูุฑูโูุง ุงุฑุฒุงุจ ุจู ููุดโูุง ู ูุงุญุฏูุง ุงุณุชูุงุฏู ูโุดูุฏ.

---

### ๐ ุขุง ูุงุฒู ุงุณุช ูฺฏูโุฏุงุฑ ุดูุฏุ
โ ุจููุ ูฺฏูโุฏุงุฑ ุขู ุถุฑูุฑ ุงุณุช.  
ฺูู ุจุฏูู ุงู ูุงูุ ุฑุงุจุทูโ ุฏูู ุจู ููุดโูุง ู ูุงุญุฏูุง ุงุฒ ุจู ูโุฑูุฏ ู ุงุฑุฒุงุจโูุง ุจูโุฏุฑุณุช ุชุฎุตุต ุฏุงุฏู ููโุดููุฏ.

๐ก ุฏุฑ ฺู ุดุฑุงุท ูโุชูุงู ุญุฐู ฺฉุฑุฏุ  
ุงฺฏุฑ ููฺฏุงูโุณุงุฒ ููุดโูุง ู ูุงุญุฏูุง ุงุฒ ุทุฑู API ุง ERP ุงูุฌุงู ุดูุฏ ู ุฏุงุฏูโูุง ุงฺฉุณู ุฏฺฏุฑ ููุจุน ุงุตู ูุจุงุดูุฏ.
</div>
      <div class="top"><a href="#top">โ ุจุงุฒฺฏุดุช ุจู ููุฑุณุช</a></div>
    </section>
    
    <section id="file-19" class="card">
      <h2><span class="num">19</span> sync_primary_supervisor.py</h2>
      <div class="content">๐ ูุงู: sync_primary_supervisor.py
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

### ๐ ุชูุถุญ ฺฉุงุฑฺฉุฑุฏ ูุงู
ุงู ูุงู ฺฉ **management command** ุงุณุช ฺฉู ุจุฑุง ููฺฏุงูโุณุงุฒ ููุฏ `direct_supervisor` ุฏุฑ ูุฏู `EmployeeProfile` ุทุฑุงุญ ุดุฏู ุงุณุช.  
ูุฏู ุขู ุชุนู ูุฏุฑ ูุณุชูู (Primary Supervisor) ูุฑ ฺฉุงุฑููุฏ ุจุฑ ุงุณุงุณ ููฺฉโูุง ุงุฑุฒุงุจ (`EvaluationLink`) ููุฌูุฏ ุงุณุช.

ูุธูู ฺฉู:
- ุจุฑุฑุณ ุชูุงู `EvaluationLink`ูุง ุจุฑุง ูุฑ ฺฉุงุฑููุฏ.  
- ุงูุชุฎุงุจ ูุฒุฏฺฉโุชุฑู ุงุฑุฒุงุจ ุจูโุนููุงู ูุฏุฑ ูุณุชูู (ุจุฑ ุงุณุงุณ ููุน ููฺฉ).  
- ุจูโุฑูุฒุฑุณุงู ููุฏ `direct_supervisor` ุฏุฑ ูพุฑููุงู ฺฉุงุฑููุฏ.

๐ ูุญูู ุงุฌุฑุง:
```bash
python manage.py sync_primary_supervisor --org "ููุช ุงููุงุณ"
```
ุฏุฑ ุญุงูุช dry-run:
```bash
python manage.py sync_primary_supervisor --org "ููุช ุงููุงุณ" --dry-run
```

---

### โ๏ธ ูุญูู ุนููฺฉุฑุฏ
1. ุชูุงู ฺฉุงุฑฺฉูุงู (`EmployeeProfile`) ูุฑุจูุท ุจู ุณุงุฒูุงู ุงูุชุฎุงุจโุดุฏู ุฎูุงูุฏู ูโุดููุฏ.  
2. ุจุฑุง ูุฑ ฺฉุงุฑููุฏุ ุชูุงู ููฺฉโูุง ุงุฑุฒุงุจ ุงู ูุงฺฉุด ูโุดููุฏ.  
3. ููฺฉโูุง ุจุฑ ุงุณุงุณ ููุน ุฑุงุจุทู ุงูููุชโุจูุฏ ูโุดููุฏ:
   - `SUPERVISOR` โ ุงูููุช 1  
   - `SECTION_HEAD` โ ุงูููุช 2  
   - `UNIT_MANAGER` โ ุงูููุช 3  
   - `ORG_HEAD` โ ุงูููุช 4  
4. ุงุฑุฒุงุจ ุจุง ุจุงูุงุชุฑู ุงูููุช ุงูุชุฎุงุจ ูโุดูุฏ.  
5. ุงฺฏุฑ ูุฏุฑ ูุนู ูุชูุงูุช ุจุงุดุฏุ ููุฏุงุฑ ุฌุฏุฏ ุฏุฑ ููุฏ `direct_supervisor` ุซุจุช ูโฺฏุฑุฏุฏ.

---

### ๐ง ุณุงุฎุชุงุฑ ู ููุทู ุฏุงุฎู
- ุงุฒ ุชุฑุงฺฉูุด ุงุชูฺฉ ุจุฑุง ุญูุธ ุตุญุช ุฏุงุฏูโูุง ุงุณุชูุงุฏู ูโฺฉูุฏ.  
- ุงุฌุฑุง dry-run ุจุฑุง ฺฏุฒุงุฑุดโฺฏุฑ ุจุฏูู ุชุบุฑ ุฏุงุฏูโูุง ูพุดุชุจุงู ูโุดูุฏ.  
- ุจูููโุณุงุฒ ุดุฏู ุจุฑุง ูพุฑุฏุงุฒุด ุณุฑุน ุฏุฑ ุณุงุฒูุงูโูุง ุจุฒุฑฺฏ ุจุง ุงุณุชูุงุฏู ุงุฒ `select_related`.

---

### ๐ ุฌุงฺฏุงู ุฏุฑ ุณุณุชู ุงุฑุฒุงุจ
ุงู ูุงู ููุด ุงุชุตุงูโุฏููุฏู ุจู ุณุณุชู ุงุฑุฒุงุจ (`EvaluationLink`) ู ุฏุงุฏูโูุง HR (`EmployeeProfile`) ุฑุง ุฏุงุฑุฏ.  
ูพุณ ุงุฒ ุงุฌุงุฏ ุง ุชุบุฑ ููฺฉโูุง ุงุฑุฒุงุจุ ุงู ุฏุณุชูุฑ ุงุทููุงู ุญุงุตู ูโฺฉูุฏ ฺฉู ูุฏุฑ ูุณุชูู ุฏุฑ ูพุฑููุงูโูุง ุจุง ูุงูุนุช ูุทุงุจูุช ุฏุงุฑุฏ.

---

### ๐ ุขุง ูุงุฒู ุงุณุช ูฺฏูโุฏุงุฑ ุดูุฏุ
โ ุจููุ ูฺฏูโุฏุงุฑ ุขู ุถุฑูุฑ ุงุณุช.  
ุฒุฑุง ุงู ูุงู ุชุถูู ูโฺฉูุฏ ฺฉู ุณุงุฎุชุงุฑ ุงุฑุฒุงุจ ู ุณุงุฎุชุงุฑ ูพุฑุณูู ููุดู ุจุง ูู ููุงููฺฏ ุจูุงููุฏ.

๐ก ุฏุฑ ฺู ุดุฑุงุท ูโุชูุงู ุญุฐู ฺฉุฑุฏุ  
ุฏุฑ ุตูุฑุช ฺฉู ุณุณุชู HR ุงุตู (ูุงููุฏ Odoo ุง ERP) ุจูโุตูุฑุช ูุณุชูู `direct_supervisor` ุฑุง ูุฏุฑุช ฺฉูุฏ.
</div>
      <div class="top"><a href="#top">โ ุจุงุฒฺฏุดุช ุจู ููุฑุณุช</a></div>
    </section>
    
    <section id="file-20" class="card">
      <h2><span class="num">20</span> sync_profiles_jobroles_from_excel.py</h2>
      <div class="content">๐ ูุงู: sync_profiles_jobroles_from_excel.py
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

### ๐ ุชูุถุญ ฺฉุงุฑฺฉุฑุฏ ูุงู
ุงู ูุงู ฺฉ **management command** ุงุณุช ฺฉู ุจุฑุง ููฺฏุงูโุณุงุฒ ููุด ุดุบู (`job_role`) ู ุฏุฑ ุตูุฑุช ูุงุฒ ูุงุญุฏ (`unit`) ฺฉุงุฑฺฉูุงู ุงุฒ ุฏุงุฏูโูุง HR ุฏุฑ ูุงู Excel ุทุฑุงุญ ุดุฏู ุงุณุช.  
ูุฏู ุขู ุจูโุฑูุฒุฑุณุงู ุงุทูุงุนุงุช ูพุฑุณูู ุจุง ุขุฎุฑู ุฏุงุฏูโูุง HR ุงุณุช.

ูุธูู ฺฉู:
- ุฎูุงูุฏู ูุงู ุงฺฉุณู ู ุดูุงุณุง ุชุบุฑุงุช ููุด ุง ูุงุญุฏ ูุฑ ฺฉุงุฑููุฏ.  
- ุจูโุฑูุฒุฑุณุงู ูุฏู `EmployeeProfile` ุจุฑ ุงุณุงุณ ุฏุงุฏูโูุง ุฌุฏุฏ.  
- ฺฏุฒุงุฑุด ุฑฺฉูุฑุฏูุง ุฌุฏุฏ ุง ูุงูุต.

๐ ูุญูู ุงุฌุฑุง:
```bash
python manage.py sync_profiles_jobroles_from_excel --file employees_latest.xlsx --update-unit
```
ุฏุฑ ุญุงูุช dry-run:
```bash
python manage.py sync_profiles_jobroles_from_excel --file employees_latest.xlsx --dry-run
```

---

### โ๏ธ ูุญูู ุนููฺฉุฑุฏ
1. ูุงู ุงฺฉุณู ุฎูุงูุฏู ูโุดูุฏ ู ุณุชููโูุง `personnel_code`, `job_role` ู `unit_code` ุดูุงุณุง ูโุดููุฏ.  
2. ุฏุงุฏูโูุง ูุฑูุงูโุณุงุฒ ูโุดููุฏ ุชุง ุงุฒ ุชฺฉุฑุงุฑ ุฌููฺฏุฑ ุดูุฏ.  
3. ุจุฑุง ูุฑ ุฑุฏู:
   - ูพุฑููุงู ุจุฑ ุงุณุงุณ `personnel_code` ูพุฏุง ูโุดูุฏ.  
   - ููุด (`job_role`) ุจูโุฑูุฒุฑุณุงู ูโุดูุฏ.  
   - ุงฺฏุฑ ฺฏุฒููโ `--update-unit` ูุนุงู ุจุงุดุฏุ ููุฏ `unit` ูุฒ ุชุบุฑ ูโฺฉูุฏ.  
4. ุฏุงุฏูโูุง ฺฏูโุดุฏู ุง ูุงููุงููฺฏ ุฏุฑ ฺฏุฒุงุฑุด ููุง ููุฑุณุช ูโุดููุฏ.

---

### ๐ง ุณุงุฎุชุงุฑ ู ููุทู ุฏุงุฎู
- ุงุฒ ฺฉุชุงุจุฎุงููโ `pandas` ุจุฑุง ุฎูุงูุฏู ุฏุงุฏูโูุง ุงุณุชูุงุฏู ูโุดูุฏ.  
- ุงุฒ update_fields ุจุฑุง ุจูโุฑูุฒุฑุณุงู ุณุฑุน ููุท ููุฏูุง ุชุบุฑโุงูุชู ุงุณุชูุงุฏู ูโุดูุฏ.  
- ุงุฒ ุชุฑุงฺฉูุด ุงุณุชูุงุฏู ููโฺฉูุฏ ฺูู ูุฑ ุฑฺฉูุฑุฏ ูุณุชูู ุงุณุชุ ุงูุง ูุฑุขูุฏ ูพุงุฏุงุฑ ู ูุงุจู ุจุงุฒุงุจ ุงุณุช.

---

### ๐ ุฌุงฺฏุงู ุฏุฑ ุณุณุชู ุงุฑุฒุงุจ
ุงู ูุงู ููุด ููู ุฏุฑ ููฺฏุงูโุณุงุฒ ุฏูุฑูโุง ุฏุงุฏูโูุง HR ุจุง ุณุณุชู ุงุฑุฒุงุจ ุฏุงุฑุฏ.  
ูพุณ ุงุฒ ุงุฌุฑุง ุขูุ ูุฏุฑุงู ู ููฺฉโูุง ุงุฑุฒุงุจ ุจุง ุฏุงุฏูโูุง ุฌุฏุฏ ููโุฎูุงู ูโุดููุฏ.

---

### ๐ ุขุง ูุงุฒู ุงุณุช ูฺฏูโุฏุงุฑ ุดูุฏุ
โ ุจููุ ูฺฏูโุฏุงุฑ ุขู ุถุฑูุฑ ุงุณุช.  
ุฒุฑุง ุจุฏูู ุขูุ ุณุณุชู ุงุฑุฒุงุจ ุนููฺฉุฑุฏ ุงุฒ ุฏุงุฏูโูุง ุจูโุฑูุฒ HR ุนูุจ ูโูุงูุฏ.

๐ก ุฏุฑ ฺู ุดุฑุงุท ูโุชูุงู ุญุฐู ฺฉุฑุฏุ  
ุงฺฏุฑ ุณุณุชู HR ุจูโุตูุฑุช ูุณุชูู ุงุทูุงุนุงุช ฺฉุงุฑฺฉูุงู ุฑุง ุฏุฑ ุฏุชุงุจุณ ุงุตู ุณุณุชู ุงุฑุฒุงุจ ุจูโุฑูุฒุฑุณุงู ฺฉูุฏ.
</div>
      <div class="top"><a href="#top">โ ุจุงุฒฺฏุดุช ุจู ููุฑุณุช</a></div>
    </section>
    

  <div class="footer">
    ยฉ 2025 โ ูุณุชูุฏ ุฏุงุฎู ุณุณุชู ุงุฑุฒุงุจ ุนููฺฉุฑุฏ | ูุงูุจ ุณุจฺฉ ุจุง ุฒููู ุฑูุดู
  </div>
</div>
</body>
</html>
